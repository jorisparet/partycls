<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>partycls.system API documentation</title>
<meta name="description" content="The physical system at hand â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<style>.homelink{display:block}.homelink img{max-width:150px;margin-left:auto;margin-right:auto;margin-bottom:.3em}</style>
<link rel="shortcut icon" href="https://raw.githubusercontent.com/jorisparet/partycls/master/logo/favicon.svg"/>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>partycls.system</code></h1>
</header>
<section id="section-intro">
<p>The physical system at hand.</p>
<p>The system of interest in a classical atomistic simulations is
composed of interacting point particles, usually enclosed in a
simulation cell.</p>
<p>This class is inspired by the <code>atooms</code> framework authored by Daniele Coslovich
See <a href="https://framagit.org/atooms/atooms">https://framagit.org/atooms/atooms</a></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
The physical system at hand.

The system of interest in a classical atomistic simulations is
composed of interacting point particles, usually enclosed in a
simulation cell.

This class is inspired by the `atooms` framework authored by Daniele Coslovich
See https://framagit.org/atooms/atooms 
&#34;&#34;&#34;

import re
import numpy
from .particle import aliases
from .core.utils import standardize_condition


class System:
    &#34;&#34;&#34;
    A system is composed of a collection of particles that lie within an
    orthorhombic cell.
    
    Parameters
    ----------
    
    particle : list of `Particle`, optional, default: None
        A list of instances of `Particle`.
    
    cell : Cell, optional, default: None
        The cell (simulation box).
    
    Attributes
    ----------
        
    particle : list of `Particle`
        All the particles in the system.
        
    cell : Cell
        The cell where all the particles lie.
    
    Examples
    --------
    
    &gt;&gt;&gt; p = [Particle(position=[0.0, 0.0, 0.0], species=&#39;A&#39;),
             Particle(position=[1.0, 1.0, 1.0], species=&#39;B&#39;)]
    &gt;&gt;&gt; c = Cell([5.0, 5.0, 5.0])
    &gt;&gt;&gt; sys = System(particle=p, cell=c)
    &#34;&#34;&#34;

    def __init__(self, particle=None, cell=None):
        if particle is None:
            particle = []
        self.particle = particle
        self.cell = cell

    @property
    def n_dimensions(self):
        &#34;&#34;&#34;
        Number of spatial dimensions, guessed from the length of
        `particle[0].position`.
        &#34;&#34;&#34;
        if len(self.particle) &gt; 0:
            return len(self.particle[0].position)
        else:
            return 0

    @property
    def density(self):
        &#34;&#34;&#34;
        Number density of the system.

        It will raise a ValueException if `cell` is None.
        &#34;&#34;&#34;
        if self.cell is None:
            return ValueError(&#39;cannot compute density without a cell&#39;)
        return len(self.particle) / self.cell.volume

    @property
    def distinct_species(self):
        &#34;&#34;&#34;
        Sorted numpy array of all the distinct species in the system.
        &#34;&#34;&#34;
        return numpy.array(sorted(set(self.get_property(&#39;species&#39;))))

    @property
    def pairs_of_species(self):
        &#34;&#34;&#34;
        List of all the possible pairs of species.
        &#34;&#34;&#34;
        pairs = []
        for s1 in self.distinct_species:
            for s2 in self.distinct_species:
                pairs.append((s1, s2))
        return pairs

    @property
    def pairs_of_species_id(self):
        &#34;&#34;&#34;
        List of all the possible pairs of species ID.
        &#34;&#34;&#34;
        pairs = []
        for i in range(len(self.distinct_species)):
            for j in range(len(self.distinct_species)):
                pairs.append((i + 1, j + 1))
        return pairs

    @property
    def chemical_fractions(self):
        &#34;&#34;&#34;
        Numpy array with the chemical fractions of each species in the system.
        &#34;&#34;&#34;
        species = self.get_property(&#39;species&#39;)
        fractions = numpy.empty(len(self.distinct_species))
        for i, species_i in enumerate(self.distinct_species):
            fractions[i] = numpy.sum(species == species_i) / len(self.particle)
        return fractions

    def get_property(self, what, subset=None):
        &#34;&#34;&#34;
        Return a numpy array with the system property specified by `what`.
        If `what` is a particle property, return the property for all particles
        in the system, or for a given subset of particles specified by `subset`.
        
        Parameters
        ----------
        what : str
            Requested system property.
        
            `what` must be of the form 
            &#34;particle.&lt;attribute&gt;&#34; or &#34;cell.&lt;attribute&gt;&#34;. 
            
            The following particle aliases are accepted:
            - &#39;position&#39;: &#39;particle.position&#39;
            - &#39;pos&#39;: &#39;particle.position&#39;
            - &#39;position[0]&#39;: &#39;particle.position[0]&#39;, 
            - &#39;pos[0]&#39;: &#39;particle.position[0]&#39;
            - &#39;x&#39;: &#39;particle.position[0]&#39;
            - &#39;position[1]&#39;: &#39;particle.position[1]&#39;,
            - &#39;pos[1]&#39;: &#39;particle.position[1]&#39;
            - &#39;y&#39;: &#39;particle.position[1]&#39;
            - &#39;position[2]&#39;: &#39;particle.position[2]&#39;
            - &#39;pos[2]&#39;: &#39;particle.position[2]&#39;
            - &#39;z&#39;: &#39;particle.position[2]&#39;
            - &#39;species&#39;: &#39;particle.species&#39;
            - &#39;spe&#39;: &#39;particle.species&#39;
            - &#39;label&#39;: &#39;particle.label&#39;
            - &#39;index&#39;: &#39;particle.index&#39;
            - &#39;mass&#39;: &#39;particle.mass&#39;
            - &#39;radius&#39;: &#39;particle.radius&#39;
            
        subset : str, optional
            Subset of particles for which the property must be dumped. Must be 
            of the form &#34;particle.&lt;attribute&gt;&#34; unless &#34;&lt;attribute&gt;&#34; is an 
            alias. The default is None (all particles will be included).
            This is ignored if `what` is cell property.
            
        Returns
        -------
        to_dump : numpy.ndarray
            Array of the requested system property.
        
        Examples
        --------
        &gt;&gt;&gt; traj = Trajectory(&#39;trajectory.xyz&#39;)
        &gt;&gt;&gt; sys = traj[0]
        &gt;&gt;&gt; pos_0 = sys.get_property(&#39;position&#39;)
        &gt;&gt;&gt; spe_0 = sys.get_property(&#39;species&#39;)
        &gt;&gt;&gt; sides = sys.get_property(&#39;cell.side&#39;)
        &#34;&#34;&#34;
        if what in aliases:
            what = aliases[what]

        # Set the property to a given subset?
        if subset is not None:
            condition = standardize_condition(subset)
        else:
            condition = &#39;True&#39;

        # Make array of the attribute
        attr = what.split(&#39;.&#39;)[-1]
        if what.startswith(&#39;particle&#39;):
            data = []
            for particle in self.particle:
                if eval(condition):
                    data.append(eval(&#39;particle.{}&#39;.format(attr)))
            data = numpy.array(data)
        elif what.startswith(&#39;cell&#39;):
            what = what.split(&#39;.&#39;)[-1]
            regexp = re.search(r&#39;(\w+)\[(\w+)\]&#39;, what)
            # cell iterable property
            if regexp:
                what = regexp.group(1)
                idx = int(regexp.group(2))
                data = getattr(self.cell, what)[idx]
            else:
                data = getattr(self.cell, attr)
        else:
            raise ValueError(&#39;Unknown attribute %s&#39; % what)
        return data

    def dump(self, what, subset=None):
        &#34;&#34;&#34;
        Alias for the method get_property.
        &#34;&#34;&#34;
        return self.get_property(what, subset=subset)

    def set_property(self, what, value, subset=None):
        &#34;&#34;&#34;
        Set a system property `what` to `value`. If `what` is a particle 
        property, set the property for all the particles in the system or for a 
        given subset of particles specified by `subset`.

        Parameters
        ----------
        what : str
            Name of the property to set. This is considered to be a particle
            property by default, unless it starts with &#34;cell&#34;, e.g. 
            &#34;cell.side&#34;.
            
        value : int, float, list, or numpy.ndarray
            Value(s) of the property to set. An instance of `int` or `float`
            will set the same value for all concerned particles. An instance
            of `list` or `numpy.ndarray` will assign a specific value to each
            particle. In this case, the size of `value` should respect the
            number of concerned particles.
            
        subset : str, optional
            Particles to which the property must be set. The default is None.
            This is ignored if `what` is cell property.

        Returns
        -------
        None.

        Examples
        --------
        &gt;&gt;&gt; sys.set_property(&#39;mass&#39;, 1.0)
        &gt;&gt;&gt; sys.set_property(&#39;radius&#39;, 0.5, &#34;species == &#39;A&#39;&#34;)
        &gt;&gt;&gt; labels = [0, 1, 0] # 3 particles in the subset
        &gt;&gt;&gt; sys.set_property(&#39;label&#39;, labels, &#34;species == &#39;B&#39;&#34;)
        &gt;&gt;&gt; sys.set_property(&#39;cell.side[0]&#39;, 2.0)

        &#34;&#34;&#34;

        # Set the property to a given subset?
        if subset is not None:
            condition = standardize_condition(subset)
        else:
            condition = &#39;True&#39;

        # Set the same scalar value to each selected particle/cell
        if not isinstance(value, (list, numpy.ndarray)):
            if what.startswith(&#39;cell&#39;):
                what = what.split(&#39;.&#39;)[-1]
                regexp = re.search(&#39;(\w+)\[(\w+)\]&#39;, what)
                # cell iterable property
                if regexp:
                    what = regexp.group(1)
                    idx = int(regexp.group(2))
                    getattr(self.cell, what)[idx] = value
                else:
                    setattr(self.cell, what, value)
            else:
                if what.startswith(&#39;particle&#39;):
                    what = what.split(&#39;.&#39;)[-1]
                for particle in self.particle:
                    if eval(condition):
                        setattr(particle, what, value)

        # Set a specific value to each particle/cell with a list/array
        else:
            if what.startswith(&#39;cell&#39;):
                what = what.split(&#39;.&#39;)[-1]
                setattr(self.cell, what, value)
            else:
                if what.startswith(&#39;particle&#39;):
                    what = what.split(&#39;.&#39;)[-1]
                c = 0
                for particle in self.particle:
                    if eval(condition):
                        setattr(particle, what, value[c])
                        c += 1

    def show(self, backend=&#39;matplotlib&#39;, color=&#39;species&#39;, **kwargs):
        &#34;&#34;&#34;
        Show a snapshot of the system and color particles
        according to an arbitrary property, such as species, cluster label, 
        etc. Current visualization backends are &#39;matplotlib&#39;, &#39;ovito&#39; and 
        &#39;3dmol&#39;.

        Parameters
        ----------
        backend : str, optional
            Name of the backend to use for visualization. 
            The default is &#39;matplotlib&#39;.
        color : str, optional
            Name of the particle property to use as basis for coloring the 
            particles. This property must be defined for all the particles in the system.
            The default is &#39;species&#39;.
        **kwargs : additional keyworded arguments (backend-dependent).

        Raises
        ------
        ValueError
            In case of unknown `backend`.

        Returns
        -------
        Figure or View (backend-dependent)
        
        Examples
        --------
        &gt;&gt;&gt; sys.show(frame=0, color=&#39;label&#39;, backend=&#39;3dmol&#39;)
        &gt;&gt;&gt; sys.show(frame=1, color=&#39;energy&#39;, backend=&#39;matplotlib&#39;, cmap=&#39;viridis&#39;)

        &#34;&#34;&#34;
        from .helpers import show_matplotlib, show_ovito, show_3dmol
        if backend == &#39;matplotlib&#39;:
            _show = show_matplotlib
        elif backend == &#39;ovito&#39;:
            _show = show_ovito
        elif backend == &#39;3dmol&#39;:
            _show = show_3dmol
        else:
            raise ValueError(&#39;unknown backend for visualization&#39;)
        return _show(self, color=color, **kwargs)

    def fold(self):
        &#34;&#34;&#34;
        Fold the particle positions into the central cell.

        Returns
        -------
        None.

        &#34;&#34;&#34;
        for p in self.particle:
            p.fold(self.cell)

    def __str__(self):
        rep = &#39;System(number_of_particles={}, species={}, chemical_fractions={}, cell={})&#39;
        return rep.format(len(self.particle),
                          self.distinct_species,
                          self.chemical_fractions,
                          self.cell.side)

    def __repr__(self):
        return self.__str__()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="partycls.system.System"><code class="flex name class">
<span>class <span class="ident">System</span></span>
<span>(</span><span>particle=None, cell=None)</span>
</code></dt>
<dd>
<div class="desc"><p>A system is composed of a collection of particles that lie within an
orthorhombic cell.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>particle</code></strong> :&ensp;<code>list</code> of <code>Particle</code>, optional, default<code>: None</code></dt>
<dd>A list of instances of <code>Particle</code>.</dd>
<dt><strong><code>cell</code></strong> :&ensp;<code>Cell</code>, optional, default<code>: None</code></dt>
<dd>The cell (simulation box).</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>particle</code></strong> :&ensp;<code>list</code> of <code>Particle</code></dt>
<dd>All the particles in the system.</dd>
<dt><strong><code>cell</code></strong> :&ensp;<code>Cell</code></dt>
<dd>The cell where all the particles lie.</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; p = [Particle(position=[0.0, 0.0, 0.0], species='A'),
         Particle(position=[1.0, 1.0, 1.0], species='B')]
&gt;&gt;&gt; c = Cell([5.0, 5.0, 5.0])
&gt;&gt;&gt; sys = System(particle=p, cell=c)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class System:
    &#34;&#34;&#34;
    A system is composed of a collection of particles that lie within an
    orthorhombic cell.
    
    Parameters
    ----------
    
    particle : list of `Particle`, optional, default: None
        A list of instances of `Particle`.
    
    cell : Cell, optional, default: None
        The cell (simulation box).
    
    Attributes
    ----------
        
    particle : list of `Particle`
        All the particles in the system.
        
    cell : Cell
        The cell where all the particles lie.
    
    Examples
    --------
    
    &gt;&gt;&gt; p = [Particle(position=[0.0, 0.0, 0.0], species=&#39;A&#39;),
             Particle(position=[1.0, 1.0, 1.0], species=&#39;B&#39;)]
    &gt;&gt;&gt; c = Cell([5.0, 5.0, 5.0])
    &gt;&gt;&gt; sys = System(particle=p, cell=c)
    &#34;&#34;&#34;

    def __init__(self, particle=None, cell=None):
        if particle is None:
            particle = []
        self.particle = particle
        self.cell = cell

    @property
    def n_dimensions(self):
        &#34;&#34;&#34;
        Number of spatial dimensions, guessed from the length of
        `particle[0].position`.
        &#34;&#34;&#34;
        if len(self.particle) &gt; 0:
            return len(self.particle[0].position)
        else:
            return 0

    @property
    def density(self):
        &#34;&#34;&#34;
        Number density of the system.

        It will raise a ValueException if `cell` is None.
        &#34;&#34;&#34;
        if self.cell is None:
            return ValueError(&#39;cannot compute density without a cell&#39;)
        return len(self.particle) / self.cell.volume

    @property
    def distinct_species(self):
        &#34;&#34;&#34;
        Sorted numpy array of all the distinct species in the system.
        &#34;&#34;&#34;
        return numpy.array(sorted(set(self.get_property(&#39;species&#39;))))

    @property
    def pairs_of_species(self):
        &#34;&#34;&#34;
        List of all the possible pairs of species.
        &#34;&#34;&#34;
        pairs = []
        for s1 in self.distinct_species:
            for s2 in self.distinct_species:
                pairs.append((s1, s2))
        return pairs

    @property
    def pairs_of_species_id(self):
        &#34;&#34;&#34;
        List of all the possible pairs of species ID.
        &#34;&#34;&#34;
        pairs = []
        for i in range(len(self.distinct_species)):
            for j in range(len(self.distinct_species)):
                pairs.append((i + 1, j + 1))
        return pairs

    @property
    def chemical_fractions(self):
        &#34;&#34;&#34;
        Numpy array with the chemical fractions of each species in the system.
        &#34;&#34;&#34;
        species = self.get_property(&#39;species&#39;)
        fractions = numpy.empty(len(self.distinct_species))
        for i, species_i in enumerate(self.distinct_species):
            fractions[i] = numpy.sum(species == species_i) / len(self.particle)
        return fractions

    def get_property(self, what, subset=None):
        &#34;&#34;&#34;
        Return a numpy array with the system property specified by `what`.
        If `what` is a particle property, return the property for all particles
        in the system, or for a given subset of particles specified by `subset`.
        
        Parameters
        ----------
        what : str
            Requested system property.
        
            `what` must be of the form 
            &#34;particle.&lt;attribute&gt;&#34; or &#34;cell.&lt;attribute&gt;&#34;. 
            
            The following particle aliases are accepted:
            - &#39;position&#39;: &#39;particle.position&#39;
            - &#39;pos&#39;: &#39;particle.position&#39;
            - &#39;position[0]&#39;: &#39;particle.position[0]&#39;, 
            - &#39;pos[0]&#39;: &#39;particle.position[0]&#39;
            - &#39;x&#39;: &#39;particle.position[0]&#39;
            - &#39;position[1]&#39;: &#39;particle.position[1]&#39;,
            - &#39;pos[1]&#39;: &#39;particle.position[1]&#39;
            - &#39;y&#39;: &#39;particle.position[1]&#39;
            - &#39;position[2]&#39;: &#39;particle.position[2]&#39;
            - &#39;pos[2]&#39;: &#39;particle.position[2]&#39;
            - &#39;z&#39;: &#39;particle.position[2]&#39;
            - &#39;species&#39;: &#39;particle.species&#39;
            - &#39;spe&#39;: &#39;particle.species&#39;
            - &#39;label&#39;: &#39;particle.label&#39;
            - &#39;index&#39;: &#39;particle.index&#39;
            - &#39;mass&#39;: &#39;particle.mass&#39;
            - &#39;radius&#39;: &#39;particle.radius&#39;
            
        subset : str, optional
            Subset of particles for which the property must be dumped. Must be 
            of the form &#34;particle.&lt;attribute&gt;&#34; unless &#34;&lt;attribute&gt;&#34; is an 
            alias. The default is None (all particles will be included).
            This is ignored if `what` is cell property.
            
        Returns
        -------
        to_dump : numpy.ndarray
            Array of the requested system property.
        
        Examples
        --------
        &gt;&gt;&gt; traj = Trajectory(&#39;trajectory.xyz&#39;)
        &gt;&gt;&gt; sys = traj[0]
        &gt;&gt;&gt; pos_0 = sys.get_property(&#39;position&#39;)
        &gt;&gt;&gt; spe_0 = sys.get_property(&#39;species&#39;)
        &gt;&gt;&gt; sides = sys.get_property(&#39;cell.side&#39;)
        &#34;&#34;&#34;
        if what in aliases:
            what = aliases[what]

        # Set the property to a given subset?
        if subset is not None:
            condition = standardize_condition(subset)
        else:
            condition = &#39;True&#39;

        # Make array of the attribute
        attr = what.split(&#39;.&#39;)[-1]
        if what.startswith(&#39;particle&#39;):
            data = []
            for particle in self.particle:
                if eval(condition):
                    data.append(eval(&#39;particle.{}&#39;.format(attr)))
            data = numpy.array(data)
        elif what.startswith(&#39;cell&#39;):
            what = what.split(&#39;.&#39;)[-1]
            regexp = re.search(r&#39;(\w+)\[(\w+)\]&#39;, what)
            # cell iterable property
            if regexp:
                what = regexp.group(1)
                idx = int(regexp.group(2))
                data = getattr(self.cell, what)[idx]
            else:
                data = getattr(self.cell, attr)
        else:
            raise ValueError(&#39;Unknown attribute %s&#39; % what)
        return data

    def dump(self, what, subset=None):
        &#34;&#34;&#34;
        Alias for the method get_property.
        &#34;&#34;&#34;
        return self.get_property(what, subset=subset)

    def set_property(self, what, value, subset=None):
        &#34;&#34;&#34;
        Set a system property `what` to `value`. If `what` is a particle 
        property, set the property for all the particles in the system or for a 
        given subset of particles specified by `subset`.

        Parameters
        ----------
        what : str
            Name of the property to set. This is considered to be a particle
            property by default, unless it starts with &#34;cell&#34;, e.g. 
            &#34;cell.side&#34;.
            
        value : int, float, list, or numpy.ndarray
            Value(s) of the property to set. An instance of `int` or `float`
            will set the same value for all concerned particles. An instance
            of `list` or `numpy.ndarray` will assign a specific value to each
            particle. In this case, the size of `value` should respect the
            number of concerned particles.
            
        subset : str, optional
            Particles to which the property must be set. The default is None.
            This is ignored if `what` is cell property.

        Returns
        -------
        None.

        Examples
        --------
        &gt;&gt;&gt; sys.set_property(&#39;mass&#39;, 1.0)
        &gt;&gt;&gt; sys.set_property(&#39;radius&#39;, 0.5, &#34;species == &#39;A&#39;&#34;)
        &gt;&gt;&gt; labels = [0, 1, 0] # 3 particles in the subset
        &gt;&gt;&gt; sys.set_property(&#39;label&#39;, labels, &#34;species == &#39;B&#39;&#34;)
        &gt;&gt;&gt; sys.set_property(&#39;cell.side[0]&#39;, 2.0)

        &#34;&#34;&#34;

        # Set the property to a given subset?
        if subset is not None:
            condition = standardize_condition(subset)
        else:
            condition = &#39;True&#39;

        # Set the same scalar value to each selected particle/cell
        if not isinstance(value, (list, numpy.ndarray)):
            if what.startswith(&#39;cell&#39;):
                what = what.split(&#39;.&#39;)[-1]
                regexp = re.search(&#39;(\w+)\[(\w+)\]&#39;, what)
                # cell iterable property
                if regexp:
                    what = regexp.group(1)
                    idx = int(regexp.group(2))
                    getattr(self.cell, what)[idx] = value
                else:
                    setattr(self.cell, what, value)
            else:
                if what.startswith(&#39;particle&#39;):
                    what = what.split(&#39;.&#39;)[-1]
                for particle in self.particle:
                    if eval(condition):
                        setattr(particle, what, value)

        # Set a specific value to each particle/cell with a list/array
        else:
            if what.startswith(&#39;cell&#39;):
                what = what.split(&#39;.&#39;)[-1]
                setattr(self.cell, what, value)
            else:
                if what.startswith(&#39;particle&#39;):
                    what = what.split(&#39;.&#39;)[-1]
                c = 0
                for particle in self.particle:
                    if eval(condition):
                        setattr(particle, what, value[c])
                        c += 1

    def show(self, backend=&#39;matplotlib&#39;, color=&#39;species&#39;, **kwargs):
        &#34;&#34;&#34;
        Show a snapshot of the system and color particles
        according to an arbitrary property, such as species, cluster label, 
        etc. Current visualization backends are &#39;matplotlib&#39;, &#39;ovito&#39; and 
        &#39;3dmol&#39;.

        Parameters
        ----------
        backend : str, optional
            Name of the backend to use for visualization. 
            The default is &#39;matplotlib&#39;.
        color : str, optional
            Name of the particle property to use as basis for coloring the 
            particles. This property must be defined for all the particles in the system.
            The default is &#39;species&#39;.
        **kwargs : additional keyworded arguments (backend-dependent).

        Raises
        ------
        ValueError
            In case of unknown `backend`.

        Returns
        -------
        Figure or View (backend-dependent)
        
        Examples
        --------
        &gt;&gt;&gt; sys.show(frame=0, color=&#39;label&#39;, backend=&#39;3dmol&#39;)
        &gt;&gt;&gt; sys.show(frame=1, color=&#39;energy&#39;, backend=&#39;matplotlib&#39;, cmap=&#39;viridis&#39;)

        &#34;&#34;&#34;
        from .helpers import show_matplotlib, show_ovito, show_3dmol
        if backend == &#39;matplotlib&#39;:
            _show = show_matplotlib
        elif backend == &#39;ovito&#39;:
            _show = show_ovito
        elif backend == &#39;3dmol&#39;:
            _show = show_3dmol
        else:
            raise ValueError(&#39;unknown backend for visualization&#39;)
        return _show(self, color=color, **kwargs)

    def fold(self):
        &#34;&#34;&#34;
        Fold the particle positions into the central cell.

        Returns
        -------
        None.

        &#34;&#34;&#34;
        for p in self.particle:
            p.fold(self.cell)

    def __str__(self):
        rep = &#39;System(number_of_particles={}, species={}, chemical_fractions={}, cell={})&#39;
        return rep.format(len(self.particle),
                          self.distinct_species,
                          self.chemical_fractions,
                          self.cell.side)

    def __repr__(self):
        return self.__str__()</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="partycls.system.System.chemical_fractions"><code class="name">var <span class="ident">chemical_fractions</span></code></dt>
<dd>
<div class="desc"><p>Numpy array with the chemical fractions of each species in the system.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def chemical_fractions(self):
    &#34;&#34;&#34;
    Numpy array with the chemical fractions of each species in the system.
    &#34;&#34;&#34;
    species = self.get_property(&#39;species&#39;)
    fractions = numpy.empty(len(self.distinct_species))
    for i, species_i in enumerate(self.distinct_species):
        fractions[i] = numpy.sum(species == species_i) / len(self.particle)
    return fractions</code></pre>
</details>
</dd>
<dt id="partycls.system.System.density"><code class="name">var <span class="ident">density</span></code></dt>
<dd>
<div class="desc"><p>Number density of the system.</p>
<p>It will raise a ValueException if <code>cell</code> is None.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def density(self):
    &#34;&#34;&#34;
    Number density of the system.

    It will raise a ValueException if `cell` is None.
    &#34;&#34;&#34;
    if self.cell is None:
        return ValueError(&#39;cannot compute density without a cell&#39;)
    return len(self.particle) / self.cell.volume</code></pre>
</details>
</dd>
<dt id="partycls.system.System.distinct_species"><code class="name">var <span class="ident">distinct_species</span></code></dt>
<dd>
<div class="desc"><p>Sorted numpy array of all the distinct species in the system.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def distinct_species(self):
    &#34;&#34;&#34;
    Sorted numpy array of all the distinct species in the system.
    &#34;&#34;&#34;
    return numpy.array(sorted(set(self.get_property(&#39;species&#39;))))</code></pre>
</details>
</dd>
<dt id="partycls.system.System.n_dimensions"><code class="name">var <span class="ident">n_dimensions</span></code></dt>
<dd>
<div class="desc"><p>Number of spatial dimensions, guessed from the length of
<code>particle[0].position</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def n_dimensions(self):
    &#34;&#34;&#34;
    Number of spatial dimensions, guessed from the length of
    `particle[0].position`.
    &#34;&#34;&#34;
    if len(self.particle) &gt; 0:
        return len(self.particle[0].position)
    else:
        return 0</code></pre>
</details>
</dd>
<dt id="partycls.system.System.pairs_of_species"><code class="name">var <span class="ident">pairs_of_species</span></code></dt>
<dd>
<div class="desc"><p>List of all the possible pairs of species.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def pairs_of_species(self):
    &#34;&#34;&#34;
    List of all the possible pairs of species.
    &#34;&#34;&#34;
    pairs = []
    for s1 in self.distinct_species:
        for s2 in self.distinct_species:
            pairs.append((s1, s2))
    return pairs</code></pre>
</details>
</dd>
<dt id="partycls.system.System.pairs_of_species_id"><code class="name">var <span class="ident">pairs_of_species_id</span></code></dt>
<dd>
<div class="desc"><p>List of all the possible pairs of species ID.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def pairs_of_species_id(self):
    &#34;&#34;&#34;
    List of all the possible pairs of species ID.
    &#34;&#34;&#34;
    pairs = []
    for i in range(len(self.distinct_species)):
        for j in range(len(self.distinct_species)):
            pairs.append((i + 1, j + 1))
    return pairs</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="partycls.system.System.dump"><code class="name flex">
<span>def <span class="ident">dump</span></span>(<span>self, what, subset=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Alias for the method get_property.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def dump(self, what, subset=None):
    &#34;&#34;&#34;
    Alias for the method get_property.
    &#34;&#34;&#34;
    return self.get_property(what, subset=subset)</code></pre>
</details>
</dd>
<dt id="partycls.system.System.fold"><code class="name flex">
<span>def <span class="ident">fold</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Fold the particle positions into the central cell.</p>
<h2 id="returns">Returns</h2>
<p>None.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def fold(self):
    &#34;&#34;&#34;
    Fold the particle positions into the central cell.

    Returns
    -------
    None.

    &#34;&#34;&#34;
    for p in self.particle:
        p.fold(self.cell)</code></pre>
</details>
</dd>
<dt id="partycls.system.System.get_property"><code class="name flex">
<span>def <span class="ident">get_property</span></span>(<span>self, what, subset=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Return a numpy array with the system property specified by <code>what</code>.
If <code>what</code> is a particle property, return the property for all particles
in the system, or for a given subset of particles specified by <code>subset</code>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>what</code></strong> :&ensp;<code>str</code></dt>
<dd>
<p>Requested system property.</p>
<p><code>what</code> must be of the form
"particle.<attribute>" or "cell.<attribute>". </p>
<p>The following particle aliases are accepted:
- 'position': 'particle.position'
- 'pos': 'particle.position'
- 'position[0]': 'particle.position[0]',
- 'pos[0]': 'particle.position[0]'
- 'x': 'particle.position[0]'
- 'position[1]': 'particle.position[1]',
- 'pos[1]': 'particle.position[1]'
- 'y': 'particle.position[1]'
- 'position[2]': 'particle.position[2]'
- 'pos[2]': 'particle.position[2]'
- 'z': 'particle.position[2]'
- 'species': 'particle.species'
- 'spe': 'particle.species'
- 'label': 'particle.label'
- 'index': 'particle.index'
- 'mass': 'particle.mass'
- 'radius': 'particle.radius'</p>
</dd>
<dt><strong><code>subset</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Subset of particles for which the property must be dumped. Must be
of the form "particle.<attribute>" unless "<attribute>" is an
alias. The default is None (all particles will be included).
This is ignored if <code>what</code> is cell property.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>to_dump</code></strong> :&ensp;<code>numpy.ndarray</code></dt>
<dd>Array of the requested system property.</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; traj = Trajectory('trajectory.xyz')
&gt;&gt;&gt; sys = traj[0]
&gt;&gt;&gt; pos_0 = sys.get_property('position')
&gt;&gt;&gt; spe_0 = sys.get_property('species')
&gt;&gt;&gt; sides = sys.get_property('cell.side')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_property(self, what, subset=None):
    &#34;&#34;&#34;
    Return a numpy array with the system property specified by `what`.
    If `what` is a particle property, return the property for all particles
    in the system, or for a given subset of particles specified by `subset`.
    
    Parameters
    ----------
    what : str
        Requested system property.
    
        `what` must be of the form 
        &#34;particle.&lt;attribute&gt;&#34; or &#34;cell.&lt;attribute&gt;&#34;. 
        
        The following particle aliases are accepted:
        - &#39;position&#39;: &#39;particle.position&#39;
        - &#39;pos&#39;: &#39;particle.position&#39;
        - &#39;position[0]&#39;: &#39;particle.position[0]&#39;, 
        - &#39;pos[0]&#39;: &#39;particle.position[0]&#39;
        - &#39;x&#39;: &#39;particle.position[0]&#39;
        - &#39;position[1]&#39;: &#39;particle.position[1]&#39;,
        - &#39;pos[1]&#39;: &#39;particle.position[1]&#39;
        - &#39;y&#39;: &#39;particle.position[1]&#39;
        - &#39;position[2]&#39;: &#39;particle.position[2]&#39;
        - &#39;pos[2]&#39;: &#39;particle.position[2]&#39;
        - &#39;z&#39;: &#39;particle.position[2]&#39;
        - &#39;species&#39;: &#39;particle.species&#39;
        - &#39;spe&#39;: &#39;particle.species&#39;
        - &#39;label&#39;: &#39;particle.label&#39;
        - &#39;index&#39;: &#39;particle.index&#39;
        - &#39;mass&#39;: &#39;particle.mass&#39;
        - &#39;radius&#39;: &#39;particle.radius&#39;
        
    subset : str, optional
        Subset of particles for which the property must be dumped. Must be 
        of the form &#34;particle.&lt;attribute&gt;&#34; unless &#34;&lt;attribute&gt;&#34; is an 
        alias. The default is None (all particles will be included).
        This is ignored if `what` is cell property.
        
    Returns
    -------
    to_dump : numpy.ndarray
        Array of the requested system property.
    
    Examples
    --------
    &gt;&gt;&gt; traj = Trajectory(&#39;trajectory.xyz&#39;)
    &gt;&gt;&gt; sys = traj[0]
    &gt;&gt;&gt; pos_0 = sys.get_property(&#39;position&#39;)
    &gt;&gt;&gt; spe_0 = sys.get_property(&#39;species&#39;)
    &gt;&gt;&gt; sides = sys.get_property(&#39;cell.side&#39;)
    &#34;&#34;&#34;
    if what in aliases:
        what = aliases[what]

    # Set the property to a given subset?
    if subset is not None:
        condition = standardize_condition(subset)
    else:
        condition = &#39;True&#39;

    # Make array of the attribute
    attr = what.split(&#39;.&#39;)[-1]
    if what.startswith(&#39;particle&#39;):
        data = []
        for particle in self.particle:
            if eval(condition):
                data.append(eval(&#39;particle.{}&#39;.format(attr)))
        data = numpy.array(data)
    elif what.startswith(&#39;cell&#39;):
        what = what.split(&#39;.&#39;)[-1]
        regexp = re.search(r&#39;(\w+)\[(\w+)\]&#39;, what)
        # cell iterable property
        if regexp:
            what = regexp.group(1)
            idx = int(regexp.group(2))
            data = getattr(self.cell, what)[idx]
        else:
            data = getattr(self.cell, attr)
    else:
        raise ValueError(&#39;Unknown attribute %s&#39; % what)
    return data</code></pre>
</details>
</dd>
<dt id="partycls.system.System.set_property"><code class="name flex">
<span>def <span class="ident">set_property</span></span>(<span>self, what, value, subset=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Set a system property <code>what</code> to <code>value</code>. If <code>what</code> is a particle
property, set the property for all the particles in the system or for a
given subset of particles specified by <code>subset</code>.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>what</code></strong> :&ensp;<code>str</code></dt>
<dd>Name of the property to set. This is considered to be a particle
property by default, unless it starts with "cell", e.g.
"cell.side".</dd>
<dt><strong><code>value</code></strong> :&ensp;<code>int, float, list,</code> or <code>numpy.ndarray</code></dt>
<dd>Value(s) of the property to set. An instance of <code>int</code> or <code>float</code>
will set the same value for all concerned particles. An instance
of <code>list</code> or <code>numpy.ndarray</code> will assign a specific value to each
particle. In this case, the size of <code>value</code> should respect the
number of concerned particles.</dd>
<dt><strong><code>subset</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Particles to which the property must be set. The default is None.
This is ignored if <code>what</code> is cell property.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None.</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; sys.set_property('mass', 1.0)
&gt;&gt;&gt; sys.set_property('radius', 0.5, &quot;species == 'A'&quot;)
&gt;&gt;&gt; labels = [0, 1, 0] # 3 particles in the subset
&gt;&gt;&gt; sys.set_property('label', labels, &quot;species == 'B'&quot;)
&gt;&gt;&gt; sys.set_property('cell.side[0]', 2.0)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_property(self, what, value, subset=None):
    &#34;&#34;&#34;
    Set a system property `what` to `value`. If `what` is a particle 
    property, set the property for all the particles in the system or for a 
    given subset of particles specified by `subset`.

    Parameters
    ----------
    what : str
        Name of the property to set. This is considered to be a particle
        property by default, unless it starts with &#34;cell&#34;, e.g. 
        &#34;cell.side&#34;.
        
    value : int, float, list, or numpy.ndarray
        Value(s) of the property to set. An instance of `int` or `float`
        will set the same value for all concerned particles. An instance
        of `list` or `numpy.ndarray` will assign a specific value to each
        particle. In this case, the size of `value` should respect the
        number of concerned particles.
        
    subset : str, optional
        Particles to which the property must be set. The default is None.
        This is ignored if `what` is cell property.

    Returns
    -------
    None.

    Examples
    --------
    &gt;&gt;&gt; sys.set_property(&#39;mass&#39;, 1.0)
    &gt;&gt;&gt; sys.set_property(&#39;radius&#39;, 0.5, &#34;species == &#39;A&#39;&#34;)
    &gt;&gt;&gt; labels = [0, 1, 0] # 3 particles in the subset
    &gt;&gt;&gt; sys.set_property(&#39;label&#39;, labels, &#34;species == &#39;B&#39;&#34;)
    &gt;&gt;&gt; sys.set_property(&#39;cell.side[0]&#39;, 2.0)

    &#34;&#34;&#34;

    # Set the property to a given subset?
    if subset is not None:
        condition = standardize_condition(subset)
    else:
        condition = &#39;True&#39;

    # Set the same scalar value to each selected particle/cell
    if not isinstance(value, (list, numpy.ndarray)):
        if what.startswith(&#39;cell&#39;):
            what = what.split(&#39;.&#39;)[-1]
            regexp = re.search(&#39;(\w+)\[(\w+)\]&#39;, what)
            # cell iterable property
            if regexp:
                what = regexp.group(1)
                idx = int(regexp.group(2))
                getattr(self.cell, what)[idx] = value
            else:
                setattr(self.cell, what, value)
        else:
            if what.startswith(&#39;particle&#39;):
                what = what.split(&#39;.&#39;)[-1]
            for particle in self.particle:
                if eval(condition):
                    setattr(particle, what, value)

    # Set a specific value to each particle/cell with a list/array
    else:
        if what.startswith(&#39;cell&#39;):
            what = what.split(&#39;.&#39;)[-1]
            setattr(self.cell, what, value)
        else:
            if what.startswith(&#39;particle&#39;):
                what = what.split(&#39;.&#39;)[-1]
            c = 0
            for particle in self.particle:
                if eval(condition):
                    setattr(particle, what, value[c])
                    c += 1</code></pre>
</details>
</dd>
<dt id="partycls.system.System.show"><code class="name flex">
<span>def <span class="ident">show</span></span>(<span>self, backend='matplotlib', color='species', **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Show a snapshot of the system and color particles
according to an arbitrary property, such as species, cluster label,
etc. Current visualization backends are 'matplotlib', 'ovito' and
'3dmol'.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>backend</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Name of the backend to use for visualization.
The default is 'matplotlib'.</dd>
<dt><strong><code>color</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Name of the particle property to use as basis for coloring the
particles. This property must be defined for all the particles in the system.
The default is 'species'.</dd>
</dl>
<p>**kwargs : additional keyworded arguments (backend-dependent).</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ValueError</code></dt>
<dd>In case of unknown <code>backend</code>.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Figure</code> or <code>View (backend-dependent)</code></dt>
<dd>&nbsp;</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python-repl">&gt;&gt;&gt; sys.show(frame=0, color='label', backend='3dmol')
&gt;&gt;&gt; sys.show(frame=1, color='energy', backend='matplotlib', cmap='viridis')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show(self, backend=&#39;matplotlib&#39;, color=&#39;species&#39;, **kwargs):
    &#34;&#34;&#34;
    Show a snapshot of the system and color particles
    according to an arbitrary property, such as species, cluster label, 
    etc. Current visualization backends are &#39;matplotlib&#39;, &#39;ovito&#39; and 
    &#39;3dmol&#39;.

    Parameters
    ----------
    backend : str, optional
        Name of the backend to use for visualization. 
        The default is &#39;matplotlib&#39;.
    color : str, optional
        Name of the particle property to use as basis for coloring the 
        particles. This property must be defined for all the particles in the system.
        The default is &#39;species&#39;.
    **kwargs : additional keyworded arguments (backend-dependent).

    Raises
    ------
    ValueError
        In case of unknown `backend`.

    Returns
    -------
    Figure or View (backend-dependent)
    
    Examples
    --------
    &gt;&gt;&gt; sys.show(frame=0, color=&#39;label&#39;, backend=&#39;3dmol&#39;)
    &gt;&gt;&gt; sys.show(frame=1, color=&#39;energy&#39;, backend=&#39;matplotlib&#39;, cmap=&#39;viridis&#39;)

    &#34;&#34;&#34;
    from .helpers import show_matplotlib, show_ovito, show_3dmol
    if backend == &#39;matplotlib&#39;:
        _show = show_matplotlib
    elif backend == &#39;ovito&#39;:
        _show = show_ovito
    elif backend == &#39;3dmol&#39;:
        _show = show_3dmol
    else:
        raise ValueError(&#39;unknown backend for visualization&#39;)
    return _show(self, color=color, **kwargs)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="Home" href="https://htmlpreview.github.io/?https://github.com/jorisparet/partycls/blob/master/docs/partycls/index.html">
<img class="logo" src="https://raw.githubusercontent.com/jorisparet/partycls/master/logo/logo.svg" alt="Logo">
</a>
</header>
<form>
<input id="lunr-search" name="q" placeholder="ðŸ”Ž Search docs" aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<!-- joris: before <h1>Index</h1> -->
<h3><em>See also:</em> <a href="https://jorisparet.github.io/partycls/docs/tutorial/">Tutorials</a></h3>
<h1><a href="index.html">API index</a></h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="partycls" href="index.html">partycls</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="partycls.system.System" href="#partycls.system.System">System</a></code></h4>
<ul class="two-column">
<li><code><a title="partycls.system.System.chemical_fractions" href="#partycls.system.System.chemical_fractions">chemical_fractions</a></code></li>
<li><code><a title="partycls.system.System.density" href="#partycls.system.System.density">density</a></code></li>
<li><code><a title="partycls.system.System.distinct_species" href="#partycls.system.System.distinct_species">distinct_species</a></code></li>
<li><code><a title="partycls.system.System.dump" href="#partycls.system.System.dump">dump</a></code></li>
<li><code><a title="partycls.system.System.fold" href="#partycls.system.System.fold">fold</a></code></li>
<li><code><a title="partycls.system.System.get_property" href="#partycls.system.System.get_property">get_property</a></code></li>
<li><code><a title="partycls.system.System.n_dimensions" href="#partycls.system.System.n_dimensions">n_dimensions</a></code></li>
<li><code><a title="partycls.system.System.pairs_of_species" href="#partycls.system.System.pairs_of_species">pairs_of_species</a></code></li>
<li><code><a title="partycls.system.System.pairs_of_species_id" href="#partycls.system.System.pairs_of_species_id">pairs_of_species_id</a></code></li>
<li><code><a title="partycls.system.System.set_property" href="#partycls.system.System.set_property">set_property</a></code></li>
<li><code><a title="partycls.system.System.show" href="#partycls.system.System.show">show</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
By Joris Paret and Daniele Coslovich. Â© Copyright 2021.
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>