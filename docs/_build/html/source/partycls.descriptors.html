<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>partycls.descriptors package &mdash; partycls 1.1.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Support and contribution" href="../support.html" />
    <link rel="prev" title="partycls.core package" href="partycls.core.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support and contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing partycls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">partycls</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API</a> &raquo;</li>
          <li><a href="partycls.html">partycls package</a> &raquo;</li>
      <li>partycls.descriptors package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/partycls.descriptors.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-partycls.descriptors">
<span id="partycls-descriptors-package"></span><h1>partycls.descriptors package<a class="headerlink" href="#module-partycls.descriptors" title="Permalink to this heading"></a></h1>
<p>Structural descriptors.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-partycls.descriptors.averaged_bo">
<span id="partycls-descriptors-averaged-bo-module"></span><h2>partycls.descriptors.averaged_bo module<a class="headerlink" href="#module-partycls.descriptors.averaged_bo" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.averaged_bo.</span></span><span class="sig-name descname"><span class="pre">LocallyAveragedBondOrientationalDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/averaged_bo.html#LocallyAveragedBondOrientationalDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.bo.BondOrientationalDescriptor" title="partycls.descriptors.bo.BondOrientationalDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BondOrientationalDescriptor</span></code></a></p>
<p>Locally averaged bond-orientational descriptor.</p>
<p>The complex coefficients <span class="math notranslate nohighlight">\(q_{lm}(i)\)</span> of particle <span class="math notranslate nohighlight">\(i\)</span> can be
averaged over its <span class="math notranslate nohighlight">\(N_b(i)\)</span> nearest neighbors, as suggested by Lechner
and Dellago <span id="id1">[<a class="reference internal" href="../tutorials/descriptors/labo.html#id4" title="Wolfgang Lechner and Christoph Dellago. Accurate determination of crystal structures based on averaged local bond order parameters. J. Chem. Phys., 129(11):114707, 2008. arXiv:0806.3345, doi:10.1063/1.2977970.">1</a>]</span>,</p>
<div class="math notranslate nohighlight">
\[\bar{q}_{lm}(i) = \frac{1}{N_b(i)+1} \left[ q_{l m}(i) + \sum_{j=1}^{N_b(i)} q_{l m}(j) \right],\]</div>
<p>and then made invariant,</p>
<div class="math notranslate nohighlight">
\[\bar{Q}_{l}(i) = \sqrt{ \frac{4\pi}{2l + 1}\sum_{m=-l}^l |\bar{q}_{lm(i)}|^2 } ,\]</div>
<p>to provide an improved descriptor for crystal structure detection.</p>
<p>We then consider <span class="math notranslate nohighlight">\(\bar{Q}_l(i)\)</span> for a sequence of orders
<span class="math notranslate nohighlight">\(\{ l_n \} = \{ l_\mathrm{min}, \dots, l_\mathrm{max} \}\)</span>. The resulting
feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{LABO}(i) = (\: \bar{Q}_{l_\mathrm{min}}(i) \;\; \dots \;\; \bar{Q}_{l_\mathrm{max}}(i) \:) .\]</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_n\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'locally</span> <span class="pre">averaged</span> <span class="pre">bond-orientational'</span></em><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'labo'</span></em><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/averaged_bo.html#LocallyAveragedBondOrientationalDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the locally averaged bond-orientational correlations for the particles
in group=0 for the grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>. Returns the data matrix
and also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with bond-orientational correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.averaged_bo.LechnerDellagoDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.averaged_bo.</span></span><span class="sig-name descname"><span class="pre">LechnerDellagoDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/averaged_bo.html#LechnerDellagoDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.averaged_bo.LechnerDellagoDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor" title="partycls.descriptors.averaged_bo.LocallyAveragedBondOrientationalDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocallyAveragedBondOrientationalDescriptor</span></code></a></p>
<p>Alias for the class <code class="docutils literal notranslate"><span class="pre">AveragedBondOrientationalDescriptor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_n\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-partycls.descriptors.ba">
<span id="partycls-descriptors-ba-module"></span><h2>partycls.descriptors.ba module<a class="headerlink" href="#module-partycls.descriptors.ba" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.ba.</span></span><span class="sig-name descname"><span class="pre">BondAngleDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/ba.html#BondAngleDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Bond-angle descriptor.</p>
<p>The <em>empirical</em> distribution of bond angles <span class="math notranslate nohighlight">\(N_i(\theta_n)\)</span> around a
central particle <span class="math notranslate nohighlight">\(i\)</span> is obtained by counting, for all the possible pairs
of it nearest neighbors <span class="math notranslate nohighlight">\((j,k)\)</span>, the number of bond angles
<span class="math notranslate nohighlight">\(\theta_{jik}\)</span> between <span class="math notranslate nohighlight">\(\theta_n = n \times \Delta \theta\)</span> and
<span class="math notranslate nohighlight">\(\theta_{n+1} = (n+1) \times \Delta \theta\)</span>, where <span class="math notranslate nohighlight">\(\Delta \theta\)</span>
has the interpration of a bin width in a histogram (see Ref.
<span id="id2">[<a class="reference internal" href="../tutorials/descriptors/gr.html#id10" title="Joris Paret, Robert L. Jack, and Daniele Coslovich. Assessing the structural heterogeneity of supercooled liquids through community inference. J. Chem. Phys., 152(14):144502, 2020. doi:10.1063/5.0004732.">1</a>]</span>).</p>
<p>We then consider <span class="math notranslate nohighlight">\(N_i(\theta_n)\)</span> for a set of angles
<span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span> that go from <span class="math notranslate nohighlight">\(\theta_0 = 0^\circ\)</span> to
<span class="math notranslate nohighlight">\(\theta_{n_\mathrm{max}}=180^\circ\)</span> by steps of <span class="math notranslate nohighlight">\(\Delta \theta\)</span>.
The resulting feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{BA}(i) = (\: N_i(\theta_0) \;\; N_i(\theta_1) \;\; \dots \;\; N_i(\theta_{n_\mathrm{max}}) \:) .\]</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of angles <span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>dtheta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Bin width <span class="math notranslate nohighlight">\(\Delta \theta\)</span> in degrees.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bond-angle'</span></em><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ba'</span></em><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.dtheta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtheta</span></span><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.dtheta" title="Permalink to this definition"></a></dt>
<dd><p>Bin width <span class="math notranslate nohighlight">\(\Delta \theta\)</span> for the grid of angles
<span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/ba.html#BondAngleDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the bond-angle correlations for the particles in group=0
for the grid of angles <span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span>. Returns the data matrix and
also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with bond-angle correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.ba.BondAngleDescriptor.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sin'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/ba.html#BondAngleDescriptor.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.ba.BondAngleDescriptor.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize a bond-angle distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distribution</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>numpy.ndarray</em></a>) – Distribution to normalize.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>default: &quot;sin&quot;</em>) – <p>Normalization method:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">method='sin'</span></code>: by construction, the probability density of has a sinusoidal enveloppe in <strong>3D</strong> for uniformly distributed points on a sphere (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method='pdf'</span></code> : gives a flat probability density for uniformly distributed points on a sphere ;</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">method</span></code> is invalid.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Normalized distribution.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-partycls.descriptors.bo">
<span id="partycls-descriptors-bo-module"></span><h2>partycls.descriptors.bo module<a class="headerlink" href="#module-partycls.descriptors.bo" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.bo.</span></span><span class="sig-name descname"><span class="pre">BondOrientationalDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/bo.html#BondOrientationalDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Bond-orientational descriptor.</p>
<p>Bond-order parameters <span id="id3">[<a class="reference internal" href="../tutorials/descriptors/bo.html#id3" title="Paul J. Steinhardt, David R. Nelson, and Marco Ronchetti. Bond-orientational order in liquids and glasses. Phys. Rev. B, 28(2):784-805, 1983. doi:10.1103/PhysRevB.28.784.">1</a>]</span> are standard measures of
structure in the first coordination shell. Let <span class="math notranslate nohighlight">\(\mathbf{r}_i\)</span> be the
position of particle <span class="math notranslate nohighlight">\(i\)</span> and define
<span class="math notranslate nohighlight">\(\mathbf{r}_{ij} = \mathbf{r}_j - \mathbf{r}_i\)</span> and
<span class="math notranslate nohighlight">\(r_{ij} = |\mathbf{r}_{ij}|\)</span>. Then consider the weighted microscopic
density around particle <span class="math notranslate nohighlight">\(i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\rho(\mathbf{r}; i) = \sum_{j=1}^{N_b(i)} w_j \delta(\mathbf{r} - \mathbf{r}_{ij})\]</div>
<p>where <span class="math notranslate nohighlight">\(w_j\)</span> is a particle-dependent weight and the sum involves a set of
<span class="math notranslate nohighlight">\(N_b(i)\)</span> particles, which defines the coordination shell of interest for
particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>We project the microscopic density on a unit-radius sphere, that is,
<span class="math notranslate nohighlight">\(\hat{\rho}(\hat{\mathbf{r}}; i) = \sum_{j=1}^{N_b(i)} w_j \delta(\mathbf{r} - \hat{\mathbf{r}}_{ij})\)</span>,
where <span class="math notranslate nohighlight">\(\hat{\mathbf{r}} = \mathbf{r} / |\mathbf{r}|\)</span> and similarly
<span class="math notranslate nohighlight">\(\hat{\mathbf{r}}_{ij} = \mathbf{r}_{ij}/|\mathbf{r}_{ij}|\)</span>. Expanding
in spherical harmonics yields</p>
<div class="math notranslate nohighlight">
\[\hat{\rho}(\hat{\mathbf{r}}; i) = \sum_{l=0}^\infty \sum_{m=-l}^l c_{l m}(i) Y_{l m}(\hat{\mathbf{r}}) ,\]</div>
<p>with coefficients</p>
<div class="math notranslate nohighlight">
\[c_{l m}(i) =  \int d\mathbf{r} \rho(\mathbf{r}; i) Y_{l m}(\hat{\mathbf{r}}) .\]</div>
<p>In the conventional bond-order analysis, one sets the weights <span class="math notranslate nohighlight">\(w_j\)</span> to
unity and considers the normalized complex coefficients,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
q_{lm}(i) &amp; = \frac{1}{N_b(i)} \int d\mathbf{r} \rho(\mathbf{r}; i) Y_{l m}(\hat{\mathbf{r}})
\nonumber \\ &amp; = \frac{1}{N_b(i)} \sum_{j=1}^{N_b(i)} Y_{l m}(\hat{\mathbf{r}}_{ij}) .
\end{align}\end{split}\]</div>
<p>The rotational invariants,</p>
<div class="math notranslate nohighlight">
\[Q_{l}(i) = \sqrt{ \frac{4\pi}{2l + 1}\sum_{m=-l}^l |q_{lm}(i)|^2 },\]</div>
<p>provide a detailed structural description of the local environment around
particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>We then consider <span class="math notranslate nohighlight">\(Q_l(i)\)</span> for a sequence of orders
<span class="math notranslate nohighlight">\(\{ l_n \} = \{ l_\mathrm{min}, \dots, l_\mathrm{max} \}\)</span>. The resulting
feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{BO}(i) = (\: Q_{l_\mathrm{min}}(i) \;\; \dots \;\; Q_{l_\mathrm{max}}(i) \:) .\]</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_n\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bond-orientational'</span></em><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bo'</span></em><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.orders">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orders</span></span><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.orders" title="Permalink to this definition"></a></dt>
<dd><p>Grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.bo.BondOrientationalDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/bo.html#BondOrientationalDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.bo.BondOrientationalDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the bond-orientational correlations for the particles in group=0
for the grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>. Returns the data matrix and also
overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with bond-orientational correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.bo.SteinhardtDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.bo.</span></span><span class="sig-name descname"><span class="pre">SteinhardtDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/bo.html#SteinhardtDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.bo.SteinhardtDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.bo.BondOrientationalDescriptor" title="partycls.descriptors.bo.BondOrientationalDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BondOrientationalDescriptor</span></code></a></p>
<p>Alias for the class <code class="docutils literal notranslate"><span class="pre">BondOrientationalDescriptor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_n\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-partycls.descriptors.compactness">
<span id="partycls-descriptors-compactness-module"></span><h2>partycls.descriptors.compactness module<a class="headerlink" href="#module-partycls.descriptors.compactness" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.compactness.</span></span><span class="sig-name descname"><span class="pre">CompactnessDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/compactness.html#CompactnessDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Compactness descriptor.</p>
<p>The compactness descriptor quantifies the local packing efficiency of a
particle <span class="math notranslate nohighlight">\(i\)</span> by comparing it to a reference ideal packing configuration
of its nearest neighbors <span id="id4">[<a class="reference internal" href="../tutorials/descriptors/compact.html#id7" title="Hua Tong and Hajime Tanaka. Revealing Hidden Structural Order Controlling Both Fast and Slow Glassy Dynamics in Supercooled Liquids. Phys. Rev. X, 8:011041, 2018. doi:10.1103/PhysRevX.8.011041.">2</a>]</span>.</p>
<p>We consider a central particle <span class="math notranslate nohighlight">\(i\)</span> surrounded by <span class="math notranslate nohighlight">\(N_b(i)\)</span> nearest
neighbors, usually identified by means of a radical Voronoi tessellation
<span id="id5">[<a class="reference internal" href="../tutorials/descriptors/overview.html#id17" title="B. J. Gellatly and J. L. Finney. Characterisation of models of multicomponent amorphous metals: the radical alternative to the voronoi polyhedron. J. Non-Cryst. Solids, 50(3):313-329, 1982. doi:10.1016/0022-3093(82)90093-X.">3</a>]</span>. We then consider triplets <span class="math notranslate nohighlight">\((j,k,m)\)</span> of
neighboring particles, for which all particles are simultaneously nearest
neighbors of each other and of particle <span class="math notranslate nohighlight">\(i\)</span>. Such a triplet is
identified with the central particle <span class="math notranslate nohighlight">\(i\)</span> to be a tetrahedron.</p>
<p>Particles in the tetrahedron <span class="math notranslate nohighlight">\(\langle ijkm \rangle\)</span> have radii
<span class="math notranslate nohighlight">\((r_i, r_j, r_k, r_m)\)</span> respectively, and the triplet <span class="math notranslate nohighlight">\((j,k,m)\)</span>
are at distances <span class="math notranslate nohighlight">\((r_{ij},r_{ik},r_{ik})\)</span> from the central particle
<span class="math notranslate nohighlight">\(i\)</span>, which are the lengths of each edge of the tetrahedron
<span class="math notranslate nohighlight">\(\langle ijkm \rangle\)</span>.</p>
<p>The <em>reference</em> tetrahedron for these four particles is the configuration in
which they are all perfectly in touch, <em>i.e.</em> the edge lengths
<span class="math notranslate nohighlight">\((\sigma_{ij},\sigma_{ik},\sigma_{im})\)</span> of this reference tetrahedron
are the sums of the corresponding particle radii,
<span class="math notranslate nohighlight">\(\sigma_{ij} = r_i + r_j\)</span>, etc.</p>
<p>The irregularity of the tetrahedron <span class="math notranslate nohighlight">\(\langle ijkm \rangle\)</span> in the
original configuration is measured as</p>
<div class="math notranslate nohighlight">
\[\omega_{\langle ijkm \rangle} = \frac{ \sum_{\langle ab \rangle} | r_{ab} - \sigma_{ab} |}{\sum_{\langle ab \rangle} \sigma_{ab}} ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\langle a b \rangle\)</span> runs over the six edges of the tetrahedron
<span class="math notranslate nohighlight">\(\langle ijkm \rangle\)</span>. Finally, the compactness of particle <span class="math notranslate nohighlight">\(i\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[\Omega(i) = \frac{1}{N_\mathrm{tetra}(i)} \sum_{\langle ijkm \rangle} \omega_{\langle ijkm \rangle} ,\]</div>
<p>where <span class="math notranslate nohighlight">\(N_\mathrm{tetra}(i)\)</span> is the total number of tetrahedra
surrounding particle <span class="math notranslate nohighlight">\(i\)</span> and the summation is performed over all these
tetrahedra. The resulting feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{C}(i) = (\: \Omega(i) \:) .\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike most descriptors, this descriptor is <strong>scalar</strong>. Its feature vector
<span class="math notranslate nohighlight">\(X^\mathrm{C}(i)\)</span> is thus composed of a single feature, and the inherited
<code class="docutils literal notranslate"><span class="pre">grid</span></code> attribute is therefore not relevant.</p>
</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'compactness'</span></em><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'compact'</span></em><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/compactness.html#CompactnessDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the compactness for the particles in group=0.
Returns the data matrix and also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with compactness.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.CompactnessDescriptor.tetrahedra">
<span class="sig-name descname"><span class="pre">tetrahedra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neigh_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neigh_neigh_i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/compactness.html#CompactnessDescriptor.tetrahedra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.compactness.CompactnessDescriptor.tetrahedra" title="Permalink to this definition"></a></dt>
<dd><p>Return a 2D numpy array that contains all the tetrahedra around
particle <code class="docutils literal notranslate"><span class="pre">i</span></code>. Each row is a 4-array with the indices of the
particles forming the tetrahedron. The first index is <code class="docutils literal notranslate"><span class="pre">i</span></code>
by construction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Index of the central particle.</p></li>
<li><p><strong>neigh_i</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – List of neighbors of the central particles.</p></li>
<li><p><strong>neigh_neigh_i</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – Neighbors of the neighbors of the central particle.
Each element is a list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tetra_i</strong> – The array that contains the indices of all the tetrahedra
around particle <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.compactness.TongTanakaDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.compactness.</span></span><span class="sig-name descname"><span class="pre">TongTanakaDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/compactness.html#TongTanakaDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.compactness.TongTanakaDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.compactness.CompactnessDescriptor" title="partycls.descriptors.compactness.CompactnessDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompactnessDescriptor</span></code></a></p>
<p>Alias for the class <code class="docutils literal notranslate"><span class="pre">CompactnessDescriptor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-partycls.descriptors.coordination">
<span id="partycls-descriptors-coordination-module"></span><h2>partycls.descriptors.coordination module<a class="headerlink" href="#module-partycls.descriptors.coordination" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.coordination.</span></span><span class="sig-name descname"><span class="pre">CoordinationDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/coordination.html#CoordinationDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Coordination descriptor.</p>
<p>The coordination number <span class="math notranslate nohighlight">\(n_\alpha(i)\)</span> of a particle <span class="math notranslate nohighlight">\(i\)</span> is given
by the number of its nearest neighbors whose chemical species
is <span class="math notranslate nohighlight">\(\alpha\)</span>, where  <span class="math notranslate nohighlight">\(\alpha\)</span> is either one of the <span class="math notranslate nohighlight">\(n\)</span>
chemical species <span class="math notranslate nohighlight">\(\{ \alpha_i \}_{i=1 \dots n}\)</span> in the trajectory
(<em>i.e.</em> partial coordination number, <span class="math notranslate nohighlight">\(\alpha = \alpha_i\)</span>) or all
species at once (<em>i.e.</em> total coordination number,
<span class="math notranslate nohighlight">\(\alpha = \mathrm{all}\)</span>).</p>
<p>The resulting <strong>full</strong> feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{N}(i) = (\: n_\mathrm{all}(i) \;\;  n_{\alpha_1}(i) \;\; \dots \;\; n_{\alpha_n}(i) \:) ,\]</div>
<p>but its size depends on whether the user requests the total coordination
number, the partial ones, or both.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By applying a filter on <code class="docutils literal notranslate"><span class="pre">group=1</span></code>, the total/partial coordination
number(s) can also be computed by considering and <strong>arbitrary</strong> subset
of particles (<em>e.g.</em> particles whose radius is smaller than a certain
value).</p>
</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of chemical species for which the coordination number is computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>total</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – Compute the total coordination number.</p></li>
<li><p><strong>partial</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Compute the coordination number <span class="math notranslate nohighlight">\(n_{\alpha_i}\)</span> for each chemical
species <span class="math notranslate nohighlight">\(\alpha_i\)</span> separately.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'coordination'</span></em><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'coord'</span></em><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.total">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.total" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.partial">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">partial</span></span><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.partial" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.coordination.CoordinationDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/coordination.html#CoordinationDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.coordination.CoordinationDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the coordination number(ss for the particles in group=0.
Returns the data matrix and also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with the coordination number(s).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-partycls.descriptors.descriptor">
<span id="partycls-descriptors-descriptor-module"></span><h2>partycls.descriptors.descriptor module<a class="headerlink" href="#module-partycls.descriptors.descriptor" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.descriptor.</span></span><span class="sig-name descname"><span class="pre">StructuralDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for any structural descriptor.</p>
<p>The descriptor is computed for the provided <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>.</p>
<p>A structural descriptor <span class="math notranslate nohighlight">\(S\)</span> is a collection of <span class="math notranslate nohighlight">\(N\)</span> individual
empirical correlation functions <span class="math notranslate nohighlight">\(\{ s_i(\vec{x}) \}\)</span> at the particle level,
defined over a grid <span class="math notranslate nohighlight">\(\{ \vec{x}_j \}\)</span> of <span class="math notranslate nohighlight">\(M\)</span> features.
These are stored in the <code class="docutils literal notranslate"><span class="pre">features</span></code> array as a matrix usually refered to as
the “data set”.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">features</span></code> array is <code class="docutils literal notranslate"><span class="pre">None</span></code> by default and is computed only when the
<code class="docutils literal notranslate"><span class="pre">compute</span></code> method is called.</p>
<p>The correlations can be calculated between two arbitrary subsets of particles
called <em>groups</em>:</p>
<ul class="simple">
<li><p>group 0 is the main group, <em>i.e.</em> particles for which the correlations are being computed</p></li>
<li><p>group 1 is the secondary group, <em>i.e.</em> particles that are being considered when computing the correlations</p></li>
</ul>
<p>These groups are formed by adding filters on particles’ properties (species, radius, position, etc.).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of features over which the structural features will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 2.0</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">StructuralDescriptor</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;A&#39;&quot;, 0), (&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">clear_filters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.accept_nans">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accept_nans</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.accept_nans" title="Permalink to this definition"></a></dt>
<dd><p>Boolean property.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. Warning: this will delete the selected rows from the
array of features! Use the method <code class="docutils literal notranslate"><span class="pre">dismiss_nans()</span></code> instead to return a
filtered copy of the array of features.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.n_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.n_samples" title="Permalink to this definition"></a></dt>
<dd><p>Total number of particles <span class="math notranslate nohighlight">\(N\)</span> in the descriptor (<em>i.e.</em> in group=0).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.n_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.n_features" title="Permalink to this definition"></a></dt>
<dd><p>Number of features <span class="math notranslate nohighlight">\(M\)</span> of the descriptor.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.average">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">average</span></span><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.average" title="Permalink to this definition"></a></dt>
<dd><p>Average feature vector <span class="math notranslate nohighlight">\(\langle s \rangle\)</span> of the descriptor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.add_filter">
<span class="sig-name descname"><span class="pre">add_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.add_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.add_filter" title="Permalink to this definition"></a></dt>
<dd><p>Add a filter on group = <code class="docutils literal notranslate"><span class="pre">group</span></code> to select the subset of particles
that respects the provided condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – <p>The condition should have the following format:
<code class="docutils literal notranslate"><span class="pre">&quot;&lt;attribute&gt;</span> <span class="pre">_operator_</span> <span class="pre">&lt;value&gt;&quot;</span></code>, where:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;attribute&gt;</span></code> is a particle property (accepts aliases)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_operator_</span></code> is a logical operator (<code class="docutils literal notranslate"><span class="pre">&quot;&lt;&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;&lt;=&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;==&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;!=&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;&gt;=&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;&gt;&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;value&gt;</span></code> is the corresponding value of <code class="docutils literal notranslate"><span class="pre">&lt;attribute&gt;</span></code> with the proper type</p></li>
</ul>
</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 0</em>) – Index of the group to which the filter must be applied.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">StructuralDescriptor</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;particle.radius &lt; 0.5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;x &lt; 0&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># particles on the left side of the box</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.clear_filters">
<span class="sig-name descname"><span class="pre">clear_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.clear_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.clear_filters" title="Permalink to this definition"></a></dt>
<dd><p>Clear all active filters on group = <code class="docutils literal notranslate"><span class="pre">group</span></code>.
All particles are included again in this group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 0</em>) – Index of the group for which to clear the filters.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.clear_all_filters">
<span class="sig-name descname"><span class="pre">clear_all_filters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.clear_all_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.clear_all_filters" title="Permalink to this definition"></a></dt>
<dd><p>Clear all active filters in both groups.
All particles are included in both groups again.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.group_size">
<span class="sig-name descname"><span class="pre">group_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.group_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.group_size" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Index of the group (0 or 1) for which to return the size.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fraction</strong> – Number of particles in group = <code class="docutils literal notranslate"><span class="pre">group</span></code> over the whole trajectory.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.group_fraction">
<span class="sig-name descname"><span class="pre">group_fraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.group_fraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.group_fraction" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Index of the group (0 or 1) for which to return the fraction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fraction</strong> – Fraction of particles inside group = <code class="docutils literal notranslate"><span class="pre">group</span></code> over the whole trajectory.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.get_group_property">
<span class="sig-name descname"><span class="pre">get_group_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.get_group_property"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.get_group_property" title="Permalink to this definition"></a></dt>
<dd><p>Return a list of numpy arrays with the properties of the particles in
group = <code class="docutils literal notranslate"><span class="pre">group</span></code>. The list size is the number of frames (<code class="docutils literal notranslate"><span class="pre">System</span></code>) in the
trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>what</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – <p>Requested particle property. <code class="docutils literal notranslate"><span class="pre">what</span></code> must be a particle property or
an alias. The following particle aliases are accepted:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'position'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pos'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'position[0]'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[0]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pos[0]'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[0]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'x'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[0]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'position[1]'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[1]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pos[1]'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[1]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'y'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[1]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'position[2]'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[2]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pos[2]'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[2]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'z'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.position[2]'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'species'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.species'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'spe'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.species'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'label'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.label'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mass'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.mass'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'radius'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.radius'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'nearest_neighbors'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.nearest_neighbors'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'neighbors'</span></code> : <code class="docutils literal notranslate"><span class="pre">particle.nearest_neighbors'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'neighbours'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.nearest_neighbors'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'voronoi_signature'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.voronoi_signature'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'signature'</span></code> : <code class="docutils literal notranslate"><span class="pre">'particle.voronoi_signature'</span></code></p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>to_dump</strong> – List of numpy arrays of the requested particle property with length equal
to the number of frames in the trajectory. Each element of the list is a
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of the requested particle property.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">StructuralDescriptor</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">get_group_property</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">get_group_property</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">get_group_property</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.dump" title="Permalink to this definition"></a></dt>
<dd><p>Alias for the method <code class="docutils literal notranslate"><span class="pre">get_group_property</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Empty compute function to be defined in child classes. Does nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Generic normalization function for child classes. Returns the input
distribution unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dist</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>numpy.ndarray</em></a>) – Distribution to normalize.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dist</strong> – Input distribution unchanged.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.StructuralDescriptor.discard_nans">
<span class="sig-name descname"><span class="pre">discard_nans</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#StructuralDescriptor.discard_nans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.StructuralDescriptor.discard_nans" title="Permalink to this definition"></a></dt>
<dd><p>Return the array of features where each row that contains
<cite>NaN</cite> is filtered out.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.DummyDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.descriptor.</span></span><span class="sig-name descname"><span class="pre">DummyDescriptor</span></span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#DummyDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.DummyDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Dummy descriptor for internal use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">StructuralDescriptor</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;A&#39;&quot;, 0), (&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">clear_filters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.DummyDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dummy'</span></em><a class="headerlink" href="#partycls.descriptors.descriptor.DummyDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.DummyDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dm'</span></em><a class="headerlink" href="#partycls.descriptors.descriptor.DummyDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.descriptor.DummyDescriptor.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/descriptor.html#DummyDescriptor.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.descriptor.DummyDescriptor.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Generic normalization function for child classes. Returns the input
distribution unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dist</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>numpy.ndarray</em></a>) – Distribution to normalize.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dist</strong> – Input distribution unchanged.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-partycls.descriptors.dscribe">
<span id="partycls-descriptors-dscribe-module"></span><h2>partycls.descriptors.dscribe module<a class="headerlink" href="#module-partycls.descriptors.dscribe" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.dscribe.DscribeDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.dscribe.</span></span><span class="sig-name descname"><span class="pre">DscribeDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/dscribe.html#DscribeDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.dscribe.DscribeDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Adapter for generic DScribe descriptors, without chemical species
information. Essentially, all the particles are considered as hydrogen
atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">StructuralDescriptor</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;A&#39;&quot;, 0), (&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">clear_filters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.dscribe.DscribeDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/dscribe.html#DscribeDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.dscribe.DscribeDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Empty compute function to be defined in child classes. Does nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.dscribe.DscribeDescriptor.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/dscribe.html#DscribeDescriptor.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.dscribe.DscribeDescriptor.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Generic normalization function for child classes. Returns the input
distribution unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dist</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>numpy.ndarray</em></a>) – Distribution to normalize.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dist</strong> – Input distribution unchanged.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.dscribe.DscribeChemicalDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.dscribe.</span></span><span class="sig-name descname"><span class="pre">DscribeChemicalDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/dscribe.html#DscribeChemicalDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.dscribe.DscribeChemicalDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.dscribe.DscribeDescriptor" title="partycls.descriptors.dscribe.DscribeDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DscribeDescriptor</span></code></a></p>
<p>Adapter for generic DScribe descriptors, with chemical species information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">StructuralDescriptor</span><span class="p">(</span><span class="s1">&#39;trajectory.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;A&#39;&quot;, 0), (&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">clear_filters</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="o">.</span><span class="n">active_filters</span>
<span class="go">[(&quot;particle.species == &#39;B&#39;&quot;, 1)]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-partycls.descriptors.radial">
<span id="partycls-descriptors-radial-module"></span><h2>partycls.descriptors.radial module<a class="headerlink" href="#module-partycls.descriptors.radial" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.radial.</span></span><span class="sig-name descname"><span class="pre">RadialDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/radial.html#RadialDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Radial descriptor.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{r}_i\)</span> be the position of particle <span class="math notranslate nohighlight">\(i\)</span> and define
<span class="math notranslate nohighlight">\(r_{ij} = |\mathbf{r}_j - \mathbf{r}_i|\)</span> as the distance between
particle <span class="math notranslate nohighlight">\(i\)</span> and its neighbors <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>We define <span class="math notranslate nohighlight">\(n_i(r_m)\)</span> as the number of neighbors <span class="math notranslate nohighlight">\(j\)</span> of particle
<span class="math notranslate nohighlight">\(i\)</span> for which <span class="math notranslate nohighlight">\(r_{ij}\)</span> is between
<span class="math notranslate nohighlight">\(r_m = r_\mathrm{min} + m \times \Delta r\)</span> and
<span class="math notranslate nohighlight">\(r_{m+1} = r_\mathrm{min} + (m+1) \times \Delta r\)</span> <span id="id6">[<a class="reference internal" href="../tutorials/descriptors/gr.html#id10" title="Joris Paret, Robert L. Jack, and Daniele Coslovich. Assessing the structural heterogeneity of supercooled liquids through community inference. J. Chem. Phys., 152(14):144502, 2020. doi:10.1063/5.0004732.">1</a>]</span>.
Here, <span class="math notranslate nohighlight">\(\Delta r\)</span> has the interpration of a bin width in a histogram.</p>
<p>We then consider <span class="math notranslate nohighlight">\(n_i(r_m)\)</span> for a set of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>
separated by <span class="math notranslate nohighlight">\(\Delta r\)</span>,
<span class="math notranslate nohighlight">\(\{ d_n \} = \{ r_0, r_1, \dots, r_{n_\mathrm{max}} \}\)</span>. The resulting
feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{R}(i) = (\: n_i(r_0) \;\; n_i(r_1) \;\; \dots \;\; n_i(r_{n_\mathrm{max}}) \:) .\]</div>
<p>See tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Bin width <span class="math notranslate nohighlight">\(\Delta r\)</span>.</p></li>
<li><p><strong>n_shells</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 3</em>) – Number of coordination shells (based on the <span class="math notranslate nohighlight">\(g(r)\)</span> of group=0).
This sets the upper bound <span class="math notranslate nohighlight">\(r_\mathrm{max}\)</span> for the distance grid
<span class="math notranslate nohighlight">\(\{d_n\}\)</span> up to which correlations are computed.</p></li>
<li><p><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>default: None</em>) – Lower and upper bounds <span class="math notranslate nohighlight">\((r_\mathrm{min},r_\mathrm{max})\)</span> to describe
the radial correlations. If set, this has the priority over <code class="docutils literal notranslate"><span class="pre">n_shells</span></code>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'radial'</span></em><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gr'</span></em><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.n_shells">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_shells</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.n_shells" title="Permalink to this definition"></a></dt>
<dd><p>Upper bound in the grid of distances <span class="math notranslate nohighlight">\(\{d_n\}\)</span> expressed in number of
coordinations shells.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.bounds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bounds</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.bounds" title="Permalink to this definition"></a></dt>
<dd><p>Lower and upper bounds <span class="math notranslate nohighlight">\((r_\mathrm{min},r_\mathrm{max})\)</span> to describe
the radial correlations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.dr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dr</span></span><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.dr" title="Permalink to this definition"></a></dt>
<dd><p>Grid spacing <span class="math notranslate nohighlight">\(\Delta r\)</span> for the grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/radial.html#RadialDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the radial correlations for the particles in group=0
for the grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>. Returns the data matrix and also
overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with radial correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.radial.RadialDescriptor.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/radial.html#RadialDescriptor.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.radial.RadialDescriptor.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize a radial distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distribution</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><em>numpy.ndarray</em></a>) – Distribution to normalize.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>default: &quot;r2&quot;</em>) – <p>Normalization method:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">method='r2'</span></code>: returns math:<cite>r^2 times g(r)</cite> (default);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method='gr'</span></code> : returns the standard <span class="math notranslate nohighlight">\(g(r)\)</span> ;</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">method</span></code> is invalid.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Normalized distribution.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-partycls.descriptors.radial_bo">
<span id="partycls-descriptors-radial-bo-module"></span><h2>partycls.descriptors.radial_bo module<a class="headerlink" href="#module-partycls.descriptors.radial_bo" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.radial_bo.</span></span><span class="sig-name descname"><span class="pre">RadialBondOrientationalDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/radial_bo.html#RadialBondOrientationalDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.bo.BondOrientationalDescriptor" title="partycls.descriptors.bo.BondOrientationalDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BondOrientationalDescriptor</span></code></a></p>
<p>Radial bond-orientational descriptor.</p>
<p>The radial bond-order descriptor captures the radial dependence of bond order
in the most straightforward way <span id="id7">[<a class="reference internal" href="../tutorials/descriptors/rbo.html#id5" title="Emanuele Boattini, Frank Smallenburg, and Laura Filion. Averaging local structure to predict the dynamic propensity in supercooled liquids. Phys. Rev. Letters, 127(8):088007, 2021. doi:10.1103/PhysRevLett.127.088007.">1</a>]</span>. It uses a radial basis
of Gaussian functions of width <span class="math notranslate nohighlight">\(\delta\)</span> centered on a grid of points
<span class="math notranslate nohighlight">\(\{d_n\}_{n=1 \dots n_\mathrm{max}}\)</span>,</p>
<div class="math notranslate nohighlight">
\[G_n(r) = \exp{\left(-\frac{(d_n - r)^2}{2\delta^2}\right)} .\]</div>
<p>The complex radial bond-order coefficients are defined as</p>
<div class="math notranslate nohighlight">
\[q_{l m n}^{R}(i) = \frac{1}{Z(i)} \sum_{j=1}^{N} G_n(r_{ij}) Y_{l m}(\hat{\mathbf{r}}_{ij}) ,\]</div>
<p>where <span class="math notranslate nohighlight">\(Z(i) = \sum_{j=1}^N G_n(r_{ij})\)</span> is a normalization constant and
the superscript <span class="math notranslate nohighlight">\(R\)</span> indicates the radial dependence of the descriptor.
In the following, we actually use</p>
<div class="math notranslate nohighlight">
\[G_n(r_{ij}) = \exp{\left(-\frac{(d_n - r_{ij})^\gamma}{2\delta^2}\right)} H(R_\mathrm{max} - r_{ij}) ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma\)</span> is an integer,
<span class="math notranslate nohighlight">\(H\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Heaviside_step_function">Heaviside step function</a>,
which allows to neglect the contributions of particles further than a distance
<span class="math notranslate nohighlight">\(R_\mathrm{max} = d_{n_\mathrm{max}} + \sigma \times \delta\)</span> from the
central particle, where <span class="math notranslate nohighlight">\(d_{n_\mathrm{max}}\)</span> is the largest distance in
the grid of points <span class="math notranslate nohighlight">\(\{ d_n \}\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> is a skin distance.
Then, only the diagonal coefficients of the power spectrum, namely</p>
<div class="math notranslate nohighlight">
\[Q_{l,n}^R(i) = \sqrt{ \frac{4\pi}{2l + 1} \sum_{m=-l}^l |q_{l m n}^R(i)|^2 } ,\]</div>
<p>are retained to form the descriptor of particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>We then consider <span class="math notranslate nohighlight">\(Q^R_{l,n}(i)\)</span> for a sequence of orders
<span class="math notranslate nohighlight">\(\{ l_m \} = \{ l_\mathrm{min}, \dots, l_\mathrm{max} \}\)</span> and for a grid
of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>. The resulting feature vector for particle
<span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{RBO}(i) = (\: \dots \;\; Q^R_{l,n}(i) \;\; Q^R_{l, n+1}(i) \;\; \dots \;\; Q^R_{l_\mathrm{max}, n_\mathrm{max}}(i) \:) .\]</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of bond orientational orders <span class="math notranslate nohighlight">\(\{l_m\}\)</span> and distances
<span class="math notranslate nohighlight">\(\{d_n\}\)</span> over which the descriptor will be computed.
It takes the form a of a list of tuples
<code class="docutils literal notranslate"><span class="pre">[(l0,d0),</span> <span class="pre">(l0,d1),</span> <span class="pre">...,</span> <span class="pre">(ln,dn),</span> <span class="pre">...]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_m \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_m \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_m\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>default:</em><em> (</em><em>1</em><em>, </em><em>1.5</em><em>)</em>) – Lower and upper bounds <span class="math notranslate nohighlight">\((d_{n_\mathrm{min}}, d_{n_\mathrm{max}})\)</span>
to define the grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>, where consecutive
points in the the grid are separated by <span class="math notranslate nohighlight">\(\Delta r\)</span>.</p></li>
<li><p><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 0.1</em>) – Grid spacing <span class="math notranslate nohighlight">\(\Delta r\)</span> to define the grid of distances
<span class="math notranslate nohighlight">\(\{ d_n \}\)</span> in the range
<span class="math notranslate nohighlight">\((d_{n_\mathrm{min}}, d_{n_\mathrm{max}})\)</span> by steps of size
<span class="math notranslate nohighlight">\(\Delta r\)</span>.</p></li>
<li><p><strong>distance_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Manually defined grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>. If different
from <code class="docutils literal notranslate"><span class="pre">None</span></code>, it  overrides the linearly-spaced grid defined by
<code class="docutils literal notranslate"><span class="pre">bounds</span></code> and <code class="docutils literal notranslate"><span class="pre">dr</span></code>.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 0.1</em>) – Shell width <span class="math notranslate nohighlight">\(\delta\)</span> to probe the local density at a distances
<span class="math notranslate nohighlight">\(\{d_n\}\)</span> from the central particle.</p></li>
<li><p><strong>skin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 2.5</em>) – Skin width <span class="math notranslate nohighlight">\(\sigma\)</span> (in units of <code class="docutils literal notranslate"><span class="pre">delta</span></code>) to consider neighbors
further than the upper bound <span class="math notranslate nohighlight">\(d_{n_\mathrm{max}}\)</span> of the grid of
distances. Neighbors will then be  identified up to
<span class="math notranslate nohighlight">\(d_{n_\mathrm{max}} + \sigma \times \delta\)</span></p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'radial</span> <span class="pre">bond-orientational'</span></em><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rbo'</span></em><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.orders">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orders</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.orders" title="Permalink to this definition"></a></dt>
<dd><p>Grid of orders <span class="math notranslate nohighlight">\(\{ l_m \}\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.bounds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bounds</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.bounds" title="Permalink to this definition"></a></dt>
<dd><p>Lower and upper bounds of the distance grid <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.dr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dr</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.dr" title="Permalink to this definition"></a></dt>
<dd><p>Grid spacing <span class="math notranslate nohighlight">\(\Delta r\)</span> to define the distance grid <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.distance_grid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance_grid</span></span><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.distance_grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/radial_bo.html#RadialBondOrientationalDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the radial bond-orientational correlations for the particles in group=0
for the grid of orders <span class="math notranslate nohighlight">\(\{ l_m \}\)</span> and grid of distances
<span class="math notranslate nohighlight">\(\{ d_n \}\)</span>. Returns the data matrix and also
overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with radial bond-orientational correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.radial_bo.BoattiniDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.radial_bo.</span></span><span class="sig-name descname"><span class="pre">BoattiniDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/radial_bo.html#BoattiniDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.radial_bo.BoattiniDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor" title="partycls.descriptors.radial_bo.RadialBondOrientationalDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadialBondOrientationalDescriptor</span></code></a></p>
<p>Alias for the class <code class="docutils literal notranslate"><span class="pre">RadialBondOrientationalDescriptor</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_m \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_m \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_m\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>default:</em><em> (</em><em>1</em><em>, </em><em>1.5</em><em>)</em>) – Lower and upper bounds <span class="math notranslate nohighlight">\((d_{n_\mathrm{min}}, d_{n_\mathrm{max}})\)</span>
to define the grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>, where consecutive
points in the the grid are separated by <span class="math notranslate nohighlight">\(\Delta r\)</span>.</p></li>
<li><p><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 0.1</em>) – Grid spacing <span class="math notranslate nohighlight">\(\Delta r\)</span> to define the grid of distances
<span class="math notranslate nohighlight">\(\{ d_n \}\)</span> in the range
<span class="math notranslate nohighlight">\((d_{n_\mathrm{min}}, d_{n_\mathrm{max}})\)</span> by steps of size
<span class="math notranslate nohighlight">\(\Delta r\)</span>.</p></li>
<li><p><strong>distance_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Manually defined grid of distances <span class="math notranslate nohighlight">\(\{ d_n \}\)</span>. If different
from <code class="docutils literal notranslate"><span class="pre">None</span></code>, it  overrides the linearly-spaced grid defined by
<code class="docutils literal notranslate"><span class="pre">bounds</span></code> and <code class="docutils literal notranslate"><span class="pre">dr</span></code>.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 0.1</em>) – Shell width <span class="math notranslate nohighlight">\(\delta\)</span> to probe the local density at a distances
<span class="math notranslate nohighlight">\(\{d_n\}\)</span> from the central particle.</p></li>
<li><p><strong>skin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 2.5</em>) – Skin width <span class="math notranslate nohighlight">\(\sigma\)</span> (in units of <code class="docutils literal notranslate"><span class="pre">delta</span></code>) to consider neighbors
further than the upper bound <span class="math notranslate nohighlight">\(d_{n_\mathrm{max}}\)</span> of the grid of
distances. Neighbors will then be  identified up to
<span class="math notranslate nohighlight">\(d_{n_\mathrm{max}} + \sigma \times \delta\)</span></p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-partycls.descriptors.smoothed_ba">
<span id="partycls-descriptors-smoothed-ba-module"></span><h2>partycls.descriptors.smoothed_ba module<a class="headerlink" href="#module-partycls.descriptors.smoothed_ba" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.smoothed_ba.</span></span><span class="sig-name descname"><span class="pre">SmoothedBondAngleDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_enlargement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/smoothed_ba.html#SmoothedBondAngleDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.ba.BondAngleDescriptor" title="partycls.descriptors.ba.BondAngleDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BondAngleDescriptor</span></code></a></p>
<p>Smoothed bond-angle descriptor.</p>
<p>This is a smooth version of the bond-angle descriptor in which the bond angles
<span class="math notranslate nohighlight">\(\theta_{jik}\)</span> are multiplied by a weighting function
<span class="math notranslate nohighlight">\(f(r_{ij}, r_{ik})\)</span> that depends on the radial distances <span class="math notranslate nohighlight">\(r_{ij}\)</span>
and <span class="math notranslate nohighlight">\(r_{ik}\)</span> between <span class="math notranslate nohighlight">\((i,j)\)</span> and <span class="math notranslate nohighlight">\((i,k)\)</span> respectively, where
<span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(k\)</span> can be any particle in the system (<em>i.e.</em> not
necessarily a nearest neighbors of <span class="math notranslate nohighlight">\(i\)</span>).</p>
<p>Essentially, we define the <em>smoothed</em> number of bond angles around particle
<span class="math notranslate nohighlight">\(i\)</span> as</p>
<div class="math notranslate nohighlight">
\[N_i^S(\theta_n) = \sum_{j=1}^N \sum_{\substack{k=1 \ k \neq j}}^N f(r_{ij}, r_{ik}) \delta(\theta_n - \theta_{jik}) ,\]</div>
<p>where the superscript <span class="math notranslate nohighlight">\(S\)</span> indicates the smooth nature of the descriptor,
and <span class="math notranslate nohighlight">\(f(r_{ij}, r_{ik})\)</span> is the following smoothing function:</p>
<div class="math notranslate nohighlight">
\[f(r_{ij}, r_{ik}) = \exp \left[ - \left[ ( r_{ij} / r_{\alpha\beta}^c )^\gamma + ( r_{ik} / r_{\alpha\beta'}^c )^\gamma \right] \right] H( R_\mathrm{max}^c - r_{ij} ) H( R_\mathrm{max}^c - r_{ik}) ,\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_{\alpha\beta}^c\)</span> and <span class="math notranslate nohighlight">\(r_{\alpha\beta'}^c\)</span> are the first minima of the corresponding partial radial distribution functions for the pairs <span class="math notranslate nohighlight">\((i,j)\)</span> and <span class="math notranslate nohighlight">\((i,k)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span> is an integer.</p></li>
<li><p><span class="math notranslate nohighlight">\(R_\mathrm{max}^c = \xi \times \max(\{ r_{\alpha\beta}^c \})\)</span> is the largest nearest neighbor cutoff rescaled by <span class="math notranslate nohighlight">\(\xi &gt; 1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Heaviside_step_function">Heavide step function</a>, which ensures for efficiency reasons, that the descriptor only has contributions from particles within a distance <span class="math notranslate nohighlight">\(R_\mathrm{max}^c\)</span>.</p></li>
</ul>
<p>We then consider <span class="math notranslate nohighlight">\(N_i^S(\theta_n)\)</span> for a set of angles
<span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span> that go from <span class="math notranslate nohighlight">\(\theta_0 = 0^\circ\)</span> to
<span class="math notranslate nohighlight">\(\theta_{n_\mathrm{max}}=180^\circ\)</span> by steps of <span class="math notranslate nohighlight">\(\Delta \theta\)</span>.
The resulting feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{SBA}(i) = (\: N_i^S(\theta_0) \;\; N_i^S(\theta_1) \;\; \dots \;\; N_i^S(\theta_{n_\mathrm{max}}) \:) .\]</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of angles <span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>dtheta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Bin width <span class="math notranslate nohighlight">\(\Delta \theta\)</span> in degrees.</p></li>
<li><p><strong>cutoff_enlargement</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 1.3</em>) – Scaling factor <span class="math notranslate nohighlight">\(\xi\)</span> for the largest nearest neighbors cutoff
<span class="math notranslate nohighlight">\(\max(\{ r_\mathrm{\alpha\beta}^c \})\)</span> to consider neighbors <span class="math notranslate nohighlight">\(j\)</span>
a distance <span class="math notranslate nohighlight">\(R_\mathrm{max}^c = \xi \times \max(\{r_{\alpha\beta}^c\})\)</span>
away from the central particle <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
<li><p><strong>exponent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Exponent <span class="math notranslate nohighlight">\(\gamma\)</span> in the smoothing function
<span class="math notranslate nohighlight">\(f(r_{ij},r_{ik})\)</span>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'smoothed-bond-angle'</span></em><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sba'</span></em><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/smoothed_ba.html#SmoothedBondAngleDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.smoothed_ba.SmoothedBondAngleDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the smoothed bond-angle correlations for the particles in group=0
for the grid of angles <span class="math notranslate nohighlight">\(\{ \theta_n \}\)</span>. Returns the data matrix and
also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with smoothed bond-angle correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-partycls.descriptors.smoothed_bo">
<span id="partycls-descriptors-smoothed-bo-module"></span><h2>partycls.descriptors.smoothed_bo module<a class="headerlink" href="#module-partycls.descriptors.smoothed_bo" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.smoothed_bo.</span></span><span class="sig-name descname"><span class="pre">SmoothedBondOrientationalDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_enlargement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/smoothed_bo.html#SmoothedBondOrientationalDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.bo.BondOrientationalDescriptor" title="partycls.descriptors.bo.BondOrientationalDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BondOrientationalDescriptor</span></code></a></p>
<p>Smoothed bond-orientational descriptor.</p>
<p>This is a smooth version of the bond-orientational descriptor, in which the
coefficients <span class="math notranslate nohighlight">\(q_{lm}(i)\)</span> are multiplied by a weighting function
<span class="math notranslate nohighlight">\(f(r)\)</span> that depends on the radial distance <span class="math notranslate nohighlight">\(r\)</span> between the central
particle <span class="math notranslate nohighlight">\(i\)</span> and other surrounding particles <span class="math notranslate nohighlight">\(j\)</span>, where <span class="math notranslate nohighlight">\(j\)</span>
can be any particle in the system (<em>i.e.</em> not necessarily a nearest neighbors
of <span class="math notranslate nohighlight">\(i\)</span>).</p>
<p>The smoothed complex coefficients are given by</p>
<div class="math notranslate nohighlight">
\[q_{lm}^{S}(i) = \frac{1}{Z(i)} \sum_{j=1}^{N} f({r}_{ij}) Y_{lm}(\hat{\mathbf{r}}_{ij}) ,\]</div>
<p>where <span class="math notranslate nohighlight">\(Z(i)=\sum_{j=1}^{N} f({r}_{ij})\)</span> is a normalization constant and
the superscript <span class="math notranslate nohighlight">\(S\)</span> indicates the smooth nature of the descriptor. We
use</p>
<div class="math notranslate nohighlight">
\[f(r_{ij}) = \exp \left[- (r_{ij} / r_{\alpha\beta}^c)^\gamma \right] H(R_{\alpha\beta}^c - r_{ij}) ,\]</div>
<p>where <span class="math notranslate nohighlight">\(r_{\alpha\beta}^c\)</span> is the first minimum of the corresponding
partial radial distribution function for the pair <span class="math notranslate nohighlight">\((i,j)\)</span> and
<span class="math notranslate nohighlight">\(\gamma\)</span> is an integer. Also, <span class="math notranslate nohighlight">\(H\)</span> is the
<a class="reference external" href="https://en.wikipedia.org/wiki/Heaviside_step_function">Heaviside step function</a>,
which ensures, for efficiency reasons, that the descriptor only has
contributions from particles within a distance
<span class="math notranslate nohighlight">\(R_{\alpha\beta}^c = \xi \times r_{\alpha\beta}^c\)</span> from the central
one, where <span class="math notranslate nohighlight">\(\xi &gt; 1\)</span> is a scaling factor.</p>
<p>The rotational invariants are defined similarly to the bond-orientational
descriptor.</p>
<p>We then consider <span class="math notranslate nohighlight">\(Q_l^S(i)\)</span> for a sequence of orders
<span class="math notranslate nohighlight">\(\{ l_n \} = \{ l_\mathrm{min}, \dots, l_\mathrm{max} \}\)</span>. The resulting
feature vector for particle <span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{SBO}(i) = (\: Q_{l_\mathrm{min}}^S(i) \;\; \dots \;\; Q_{l_\mathrm{max}}^S(i) \:) .\]</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.grid" title="Permalink to this definition"></a></dt>
<dd><p>Grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>lmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 1</em>) – Minimum order <span class="math notranslate nohighlight">\(l_\mathrm{min}\)</span>. This sets the lower bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Maximum order <span class="math notranslate nohighlight">\(l_\mathrm{max}\)</span>. This sets the upper bound of
the grid <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>.</p></li>
<li><p><strong>orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>default: None</em>) – Sequence <span class="math notranslate nohighlight">\(\{l_n\}\)</span> of specific orders to compute, <em>e.g.</em>
<code class="docutils literal notranslate"><span class="pre">orders=[4,6]</span></code>. This has the priority over <code class="docutils literal notranslate"><span class="pre">lmin</span></code> and <code class="docutils literal notranslate"><span class="pre">lmax</span></code>.</p></li>
<li><p><strong>cutoff_enlargement</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>default: 1.3</em>) – Scaling factor <span class="math notranslate nohighlight">\(\xi\)</span> for the nearest neighbors cutoffs
<span class="math notranslate nohighlight">\(r_{\alpha\beta}^c\)</span> to consider neighbors <span class="math notranslate nohighlight">\(j\)</span> a distance
<span class="math notranslate nohighlight">\(R_{\alpha\beta}^c = \xi \times r_{\alpha\beta}^c\)</span> away from the
central particle <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
<li><p><strong>exponent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>default: 8</em>) – Exponent <span class="math notranslate nohighlight">\(\gamma\)</span> in the smoothing function
<span class="math notranslate nohighlight">\(f(r_{ij})\)</span>.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'smoothed</span> <span class="pre">bond-orientational'</span></em><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sbo'</span></em><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/smoothed_bo.html#SmoothedBondOrientationalDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.smoothed_bo.SmoothedBondOrientationalDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the smoothed bond-orientational correlations for the particles in
group=0 for the grid of orders <span class="math notranslate nohighlight">\(\{ l_n \}\)</span>. Returns the data matrix
and also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with bond-orientational correlations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-partycls.descriptors.tetrahedrality">
<span id="partycls-descriptors-tetrahedrality-module"></span><h2>partycls.descriptors.tetrahedrality module<a class="headerlink" href="#module-partycls.descriptors.tetrahedrality" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">partycls.descriptors.tetrahedrality.</span></span><span class="sig-name descname"><span class="pre">TetrahedralDescriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/tetrahedrality.html#TetrahedralDescriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#partycls.descriptors.descriptor.StructuralDescriptor" title="partycls.descriptors.descriptor.StructuralDescriptor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuralDescriptor</span></code></a></p>
<p>Tetrahedral descriptor.</p>
<p>The degree of tetrahedrality of a particle <span class="math notranslate nohighlight">\(i\)</span> is the average deviation
of the bond angles <span class="math notranslate nohighlight">\(\{ \theta_{jik} \}\)</span> between <span class="math notranslate nohighlight">\(i\)</span> and all the
possible pairs of its nearest neighbors <span class="math notranslate nohighlight">\((j,k)\)</span> from the ideal angle in
a tetrahedron, <span class="math notranslate nohighlight">\(\theta_\mathrm{tetra} = 109.5^\circ\)</span>:</p>
<div class="math notranslate nohighlight">
\[T(i) = \frac{1}{N_\mathrm{ba}(i)} \sum_{j=1}^{N_b(i)} \sum_{\substack{k=1 \ k \neq j}}^{N_b(i)} | \cos(\theta_{jik}) - \cos(\theta_\mathrm{tetra}) | ,\]</div>
<p>where <span class="math notranslate nohighlight">\(N_\mathrm{ba}(i)\)</span> is the total number of bond angles (<em>i.e.</em> the
number of pairs) around particle <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(N_b(i)\)</span> is the number
of its nearest neighbors. The resulting feature vector for particle
<span class="math notranslate nohighlight">\(i\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[X^\mathrm{T}(i) = (\: T(i) \:) .\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike most descriptors, this descriptor is <strong>scalar</strong>. Its feature vector
<span class="math notranslate nohighlight">\(X^\mathrm{T}(i)\)</span> is thus composed of a single feature, and the
inherited <code class="docutils literal notranslate"><span class="pre">grid</span></code> attribute is therefore not relevant.</p>
</div>
<p>See the tutorials for more details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.trajectory">
<span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Trajectory on which the structural descriptor will be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.active_filters">
<span class="sig-name descname"><span class="pre">active_filters</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.active_filters" title="Permalink to this definition"></a></dt>
<dd><p>All the active filters on both groups prior to the computation of the
descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.dimension">
<span class="sig-name descname"><span class="pre">dimension</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.dimension" title="Permalink to this definition"></a></dt>
<dd><p>Spatial dimension of the descriptor (2 or 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.features" title="Permalink to this definition"></a></dt>
<dd><p>Array of all the structural features for the particles in group=0 in
accordance with the defined filters (if any). This attribute is
initialized when the method <code class="docutils literal notranslate"><span class="pre">compute</span></code> is called (default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.groups" title="Permalink to this definition"></a></dt>
<dd><p>Composition of the groups: <code class="docutils literal notranslate"><span class="pre">groups[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">groups[1]</span></code> contain lists of all
the <code class="docutils literal notranslate"><span class="pre">Particle</span></code> instances in groups 0 and 1 respectively. Each element of
the tuple is a list of <code class="docutils literal notranslate"><span class="pre">Particle</span></code> in <code class="docutils literal notranslate"><span class="pre">trajectory</span></code>, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">groups[0][0]</span></code>
is the list of all the particles in the first frame of <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> that
belong to group=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.verbose" title="Permalink to this definition"></a></dt>
<dd><p>Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.neighbors_boost">
<span class="sig-name descname"><span class="pre">neighbors_boost</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.neighbors_boost" title="Permalink to this definition"></a></dt>
<dd><p>Scaling factor to estimate the number of neighbors relative to a
an ideal gas with the same density. This is used internally to set
the dimensions of lists of neighbors. A too small number creates a
risk of overfilling the lists of neighbors, and a too large number
increases memory usage. This only works if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>
has valid cutoffs in the <code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list
attribute. This sets the value of the <code class="docutils literal notranslate"><span class="pre">max_num_neighbors</span></code> attribute
during the computation of the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, default: 1.5</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.max_num_neighbors">
<span class="sig-name descname"><span class="pre">max_num_neighbors</span></span><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.max_num_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of neighbors. This is used internally to set the dimensions
of lists of neighbors. This number is automatically adjusted to limit
memory usage if the associated <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> has valid cutoffs in the
<code class="docutils literal notranslate"><span class="pre">Trajectory.nearest_neighbors_cutoffs</span></code> list attribute. The
default value <code class="docutils literal notranslate"><span class="pre">100</span></code> is used if no cutoffs can be used to estimate a
better value. The default value is sufficient in most cases, otherwise
this number can manually be increased <strong>before</strong> computing the descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a>, default: 100</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<a class="reference internal" href="partycls.html#partycls.trajectory.Trajectory" title="partycls.trajectory.Trajectory"><em>Trajectory</em></a>) – Trajectory on which the structural descriptor will be computed.</p></li>
<li><p><strong>accept_nans</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, discard any row from the array of features that contains a
<cite>NaN</cite> element. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, keep <cite>NaN</cite> elements in the array of features.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>default: False</em>) – Show progress information and warnings about the computation of the
descriptor when verbose is <code class="docutils literal notranslate"><span class="pre">True</span></code>, and remain silent when verbose
is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tetrahedral'</span></em><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.symbol">
<span class="sig-name descname"><span class="pre">symbol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tetra'</span></em><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="partycls.descriptors.tetrahedrality.TetrahedralDescriptor.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/partycls/descriptors/tetrahedrality.html#TetrahedralDescriptor.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#partycls.descriptors.tetrahedrality.TetrahedralDescriptor.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the tetrahedrality for the particles in group=0.
Returns the data matrix and also overwrites the <code class="docutils literal notranslate"><span class="pre">features</span></code> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>features</strong> – Data matrix with the degree of tetrahedrality.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="partycls.core.html" class="btn btn-neutral float-left" title="partycls.core package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../support.html" class="btn btn-neutral float-right" title="Support and contribution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Joris Paret.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>