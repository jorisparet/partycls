<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Trajectories &mdash; partycls 1.1.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Workflow" href="2_workflow.html" />
    <link rel="prev" title="Tutorials" href="../../tutorials.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#detailed-examples">Detailed examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. Trajectories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Opening-and-handling-a-trajectory">1.1. Opening and handling a trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Dealing-with-different-trajectory-formats">1.2. Dealing with different trajectory formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Dealing-with-additional-particle-properties">1.3. Dealing with additional particle properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Setting-or-modifying-a-particle-property">1.4. Setting or modifying a particle property</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Visualizing-a-trajectory">1.5. Visualizing a trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Writing-a-trajectory">1.6. Writing a trajectory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="2_workflow.html">2. Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="3_descriptors.html">3. Descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="4_going_further.html">4. Going further</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#structural-descriptors">Structural descriptors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Support and contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing partycls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">partycls</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../tutorials.html">Tutorials</a> &raquo;</li>
      <li><span class="section-number">1. </span>Trajectories</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/notebooks/1_trajectory.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Trajectories">
<h1><span class="section-number">1. </span>Trajectories<a class="headerlink" href="#Trajectories" title="Permalink to this headline"></a></h1>
<p>This notebook shows how to read and manipulate the trajectories in which the system’s configurations are stored.</p>
<div class="section" id="Opening-and-handling-a-trajectory">
<h2><span class="section-number">1.1. </span>Opening and handling a trajectory<a class="headerlink" href="#Opening-and-handling-a-trajectory" title="Permalink to this headline"></a></h2>
<p>A trajectory file can directly be read using the <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> class. Let’s open our first trajectory file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">partycls</span> <span class="kn">import</span> <span class="n">Trajectory</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/kalj_N150.xyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> object is iterable, and is composed of <code class="docutils literal notranslate"><span class="pre">System</span></code> objects (<em>i.e.</em> frames).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of frames in the trajectory</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
101
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">first</span></code>, <code class="docutils literal notranslate"><span class="pre">last</span></code> and <code class="docutils literal notranslate"><span class="pre">step</span></code> parameters allow to slice the trajectory to read a subset of the frames: * <code class="docutils literal notranslate"><span class="pre">first</span></code> is the index of the first frame to read (default is <code class="docutils literal notranslate"><span class="pre">0</span></code>) ; * <code class="docutils literal notranslate"><span class="pre">last</span></code> is the index of the last frame to read (default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning it will read up to the last frame) ; * <code class="docutils literal notranslate"><span class="pre">step</span></code> is the increment between two consecutive frames to read (default is <code class="docutils literal notranslate"><span class="pre">1</span></code>, meaning that every frame is read). Setting <code class="docutils literal notranslate"><span class="pre">step=2</span></code> means that every 2 frames only will be read ;</p>
<p>For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the 10 first frames only</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/kalj_N150.xyz&#39;</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10
</pre></div></div>
</div>
<p>Now, let’s have a look at the first frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
System(number_of_particles=150, species=[&#39;A&#39; &#39;B&#39;], chemical_fractions=[0.8 0.2], cell=[5. 5. 5.])
</pre></div></div>
</div>
<p>This tells us about the main features of the system. In particular, our <code class="docutils literal notranslate"><span class="pre">System</span></code> is enclosed in an orthorombic simulation cell. By default, periodic boundary conditions are assumed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cell(side=[5. 5. 5.], periodic=[ True  True  True], volume=125.0)
</pre></div></div>
</div>
<p>The code accepts both 2- and 3-dimensional systems. The spatial dimension is guessed from the number of sides the cell has in the input file.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">System</span></code> is composed of particles, accessible via the iterable<code class="docutils literal notranslate"><span class="pre">particle</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Particle(position=[ 0.819926 -1.760086  0.36845 ], species=A, label=-1, radius=0.5, index=139812834853552, species_id=1)
</pre></div></div>
</div>
<p>Particles have several attributes, such as: - A position vector ; - A species (chemical symbol or type) ; - A radius (by default set to <code class="docutils literal notranslate"><span class="pre">0.5</span></code>, needed for visualization purposes) ; - A label, which is the index of the cluster that particle belongs to. Its default value is <code class="docutils literal notranslate"><span class="pre">-1</span></code> but it is automatically assigned after a clustering as we will see in the <strong>Workflow</strong> notebook ; - An index, which is a unique integer value to identify the particle ;</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position :&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Species :&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">species</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Radius :&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="s1">&#39;(default)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Label :&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Index :&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Position : [ 0.819926 -1.760086  0.36845 ]
Species : A
Radius : 0.5 (default)
Label : -1
Index : 139812834853552
</pre></div></div>
</div>
<p>We can assign arbitrary properties to a particle</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Particle(position=[ 0.819926 -1.760086  0.36845 ], species=A, label=-1, radius=0.5, index=139812834853552, species_id=1, mass=0.5)
</pre></div></div>
</div>
<p>All these properties can also be accessed via the method <code class="docutils literal notranslate"><span class="pre">get_property</span></code> (also called <code class="docutils literal notranslate"><span class="pre">dump</span></code> for short), either from <code class="docutils literal notranslate"><span class="pre">System</span></code> or <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> : * For a <code class="docutils literal notranslate"><span class="pre">System</span></code>, this will return a numpy array:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Positions of all the particles in the first frame</span>
<span class="n">pos_0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span>
<span class="c1"># Show the positions of the 5 first particles</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos_0</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.819926 -1.760086  0.36845 ]
 [ 0.29098   1.24579  -2.495344]
 [ 2.484607  0.35245   1.371003]
 [-1.02062  -1.927986  0.663132]
 [-0.816276  2.062004  0.421107]]
</pre></div></div>
</div>
<ul class="simple">
<li><p>For a <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>, this will return a list of numpy arrays with length <code class="docutils literal notranslate"><span class="pre">len(traj)</span></code>:</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_pos</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_pos</span><span class="p">))</span>
<span class="c1"># Positions in the first frame is the first element of the dumped list</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10
[[ 0.819926 -1.760086  0.36845 ]
 [ 0.29098   1.24579  -2.495344]
 [ 2.484607  0.35245   1.371003]
 [-1.02062  -1.927986  0.663132]
 [-0.816276  2.062004  0.421107]]
</pre></div></div>
</div>
<p>This method accepts aliases for common particle properties, such as the position of the species:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use &quot;dump&quot; instead of &quot;get_property&quot; (equivalent)</span>
<span class="n">pos_0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="c1"># x position only</span>
<span class="n">spe_0</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;spe&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pos_0</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_0</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spe_0</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.819926 -1.760086  0.36845 ]
 [ 0.29098   1.24579  -2.495344]
 [ 2.484607  0.35245   1.371003]
 [-1.02062  -1.927986  0.663132]
 [-0.816276  2.062004  0.421107]]
[ 0.819926  0.29098   2.484607 -1.02062  -0.816276]
[&#39;A&#39; &#39;A&#39; &#39;A&#39; &#39;A&#39; &#39;A&#39;]
</pre></div></div>
</div>
<p>However, any other additional particle property should be accessed using the following syntax:</p>
<p><code class="docutils literal notranslate"><span class="pre">dump('particle.property')</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">property</span></code> is the name of the corresponding particle property, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">particle.mass</span></code>, <code class="docutils literal notranslate"><span class="pre">particle.radius</span></code>, etc. Be sure that this property is defined for <strong>all</strong> the particles before calling the <code class="docutils literal notranslate"><span class="pre">dump</span></code> method (<em>e.g.</em> this is not the case here for the <code class="docutils literal notranslate"><span class="pre">mass</span></code> property that was defined for one particle only).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">set_property</span></code>/<code class="docutils literal notranslate"><span class="pre">dump</span></code> method also works for cell properties. No aliases are accepted, so it must always be in the form of <code class="docutils literal notranslate"><span class="pre">'cell.property'</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Volumes of the cells for all the frames in the trajectory</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;volumes :&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;cell.volume&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
volumes : [125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0, 125.0]
</pre></div></div>
</div>
<p>It is also possible to get the properties of a given <strong>subset of particles</strong>, by specifying a <code class="docutils literal notranslate"><span class="pre">subset</span></code> parameter in the form of a condition:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Positions of the particles on the left side of the box (x &lt; 0.0)</span>
<span class="n">left</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="s1">&#39;particle.position[0] &lt; 0.0&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>

<span class="c1"># Positions of the particles on the right side of the box (x &gt; 0.0)</span>
<span class="c1">#  (use an alias for the x position)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 0.0&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">right</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-1.02062  -1.927986  0.663132]
 [-0.816276  2.062004  0.421107]
 [-0.32223   0.751391 -1.607461]
 [-1.595135  2.262852 -1.671871]
 [-2.174664  0.643808 -1.462404]
 [-0.700083 -1.346258  2.163989]
 [-2.180021  1.253083 -0.613079]
 [-1.513521 -1.463041 -1.99653 ]
 [-1.050631 -0.873367  0.633333]
 [-0.575498 -0.407806 -0.43532 ]]

 [[ 0.819926 -1.760086  0.36845 ]
 [ 0.29098   1.24579  -2.495344]
 [ 2.484607  0.35245   1.371003]
 [ 1.890651 -0.623108 -0.60892 ]
 [ 1.046703  0.46165   2.148453]
 [ 2.102494  2.077016 -0.048818]
 [ 0.162451  1.761205  0.442532]
 [ 1.956404  2.423274 -2.307274]
 [ 0.961139  2.295941  0.567796]
 [ 1.311121 -0.526285 -1.422479]]
</pre></div></div>
</div>
<p><strong>N.B.</strong> the <code class="docutils literal notranslate"><span class="pre">subset</span></code> parameter only concerns particle properties. It will be ignored when dumping a cell property.</p>
<p>Finally, some properties of our <code class="docutils literal notranslate"><span class="pre">System</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of spatial dimensions :&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">n_dimensions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of particles :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">particle</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Density :&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distinct species :&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">distinct_species</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chemical fractions :&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">chemical_fractions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pairs of species :&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">pairs_of_species</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pairs of species ID :&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">pairs_of_species_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of spatial dimensions : 3
Number of particles : 150
Density : 1.2
Distinct species : [&#39;A&#39; &#39;B&#39;]
Chemical fractions : [0.8 0.2]
Pairs of species : [(&#39;A&#39;, &#39;A&#39;), (&#39;A&#39;, &#39;B&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;B&#39;, &#39;B&#39;)]
Pairs of species ID : [(1, 1), (1, 2), (2, 1), (2, 2)]
</pre></div></div>
</div>
<p>The very last property, <code class="docutils literal notranslate"><span class="pre">pairs_of_species_id</span></code>, allows us to standardize the species in the trajectory, from a literal name or symbol to an integer value. Here, for example, we have: - <code class="docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">1</span></code> - <code class="docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">2</span></code></p>
<p>In more complex cases, for instance when dealing with atomic symbols such as <code class="docutils literal notranslate"><span class="pre">&quot;Si&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;C&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;O&quot;</span></code>, etc., this standardization can come in handy.</p>
</div>
<div class="section" id="Dealing-with-different-trajectory-formats">
<h2><span class="section-number">1.2. </span>Dealing with different trajectory formats<a class="headerlink" href="#Dealing-with-different-trajectory-formats" title="Permalink to this headline"></a></h2>
<p>Natively, the code only reads/write standard <a class="reference external" href="https://en.wikipedia.org/wiki/XYZ_file_format">XYZ</a> trajectories (with a <code class="docutils literal notranslate"><span class="pre">cell</span></code> attribute in the comment line) and <a class="reference external" href="http://rumd.org/">RUMD</a> trajectories:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open a XYZ trajectory</span>
<span class="c1">#  default value for `fmt` is &quot;xyz&quot;</span>
<span class="n">traj_xyz</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/kalj_N150.xyz&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_xyz</span><span class="p">)</span>

<span class="c1"># Open a RUMD trajectory</span>
<span class="n">traj_rumd</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/kalj_N256_rho1.185_rumd.xyz.gz&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;rumd&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_rumd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Trajectory(filename=&#34;../data/kalj_N150.xyz&#34;, number_of_frames=101)
Trajectory(filename=&#34;../data/kalj_N256_rho1.185_rumd.xyz.gz&#34;, number_of_frames=1)
</pre></div></div>
</div>
<p>However, it is possible to rely on external packages to read more formats such as <a class="reference external" href="https://lammps.sandia.gov/">LAMMPS</a>, <a class="reference external" href="https://www.gromacs.org/">GROMACS</a>, etc. or even your custom trajectory formats.</p>
<p>These two external packages are: * <a class="reference external" href="https://framagit.org/atooms/atooms">atooms</a>, a Python framework for simulations of interacting particles ; * <a class="reference external" href="https://www.mdtraj.org/1.9.5/index.html">MDTraj</a>, a Python library that allows users to manipulate molecular dynamics trajectories ;</p>
<p>With these dependencies properly installed in the Python environment, it is possible to use them as backend when creating an instance of <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>:</p>
<div class="section" id="Atooms">
<h3><span class="section-number">1.2.1. </span>Atooms<a class="headerlink" href="#Atooms" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open a LAMMPS trajectory using atooms</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/lj_N256_rho1.0.atom&#39;</span><span class="p">,</span>
                  <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;lammps&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;atooms&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of frames :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of frames : 6
System(number_of_particles=256, species=[&#39;1&#39;], chemical_fractions=[1.], cell=[6.3496 6.3496 6.3496])
</pre></div></div>
</div>
<p>When using <code class="docutils literal notranslate"><span class="pre">backend=&quot;atooms&quot;</span></code>, the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> parameter must be set to the right trajectory format to select the appropriate parser. This is indepedent of the file extension.</p>
</div>
<div class="section" id="MDTraj">
<h3><span class="section-number">1.2.2. </span>MDTraj<a class="headerlink" href="#MDTraj" title="Permalink to this headline"></a></h3>
<p>When using <code class="docutils literal notranslate"><span class="pre">backend=&quot;mdtraj&quot;</span></code>, however, the file extension is used to determine the correct format (the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> parameter can thus be ignored).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open a PDB trajectory using MDTraj</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/frame0.pdb&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;mdtraj&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of frames :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of frames : 501
System(number_of_particles=22, species=[&#39;C&#39; &#39;H&#39; &#39;N&#39; &#39;O&#39;], chemical_fractions=[0.27272727 0.54545455 0.09090909 0.09090909], cell=[1. 1. 1.])
</pre></div></div>
</div>
<p>An additional <code class="docutils literal notranslate"><span class="pre">top</span></code> parameter can be specified for trajectory files that require external topology information (see <a class="reference external" href="https://www.mdtraj.org/1.9.5/index.html">MDTraj</a> documentation). This parameter is specific to MDTraj and will be ignored when using atooms or native formats.</p>
</div>
</div>
<div class="section" id="Dealing-with-additional-particle-properties">
<h2><span class="section-number">1.3. </span>Dealing with additional particle properties<a class="headerlink" href="#Dealing-with-additional-particle-properties" title="Permalink to this headline"></a></h2>
<p>Some trajectory formats may contain additional particle properties (mass, radius, etc.). It is possible to read these properties from the file using the parameter <code class="docutils literal notranslate"><span class="pre">additional_fields</span></code> when creating an instance of <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code>.</p>
<p>Let’s consider a simple XYZ trajectory file called <code class="docutils literal notranslate"><span class="pre">traj_with_masses.xyz</span></code> with 2 frames and only 3 particles, as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">columns:id,pos,mass</span> <span class="pre">cell:1.0,1.0,1.0</span> <span class="pre">A</span> <span class="pre">0.1</span> <span class="pre">0.0</span> <span class="pre">0.0</span> <span class="pre">0.5</span> <span class="pre">B</span> <span class="pre">0.0</span> <span class="pre">0.1</span> <span class="pre">0.0</span> <span class="pre">0.25</span> <span class="pre">B</span> <span class="pre">0.0</span> <span class="pre">0.0</span> <span class="pre">0.1</span> <span class="pre">0.25</span> <span class="pre">3</span> <span class="pre">columns:id,pos,mass</span> <span class="pre">cell:1.0,1.0,1.0</span> <span class="pre">A</span> <span class="pre">0.2</span> <span class="pre">0.0</span> <span class="pre">0.0</span> <span class="pre">0.5</span> <span class="pre">B</span> <span class="pre">0.0</span> <span class="pre">0.2</span> <span class="pre">0.0</span> <span class="pre">0.25</span> <span class="pre">B</span> <span class="pre">0.0</span> <span class="pre">0.0</span> <span class="pre">0.2</span> <span class="pre">0.25</span></code></p>
<p>As long as the property is specified in the header, it can be read when opening the trajectory:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specifying an additional field</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/traj_with_masses.xyz&#39;</span><span class="p">,</span>
                  <span class="n">additional_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Masses :&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.mass&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Particle(position=[0.1 0.  0. ], species=A, label=-1, radius=0.5, index=139812835987664, mass=0.5, species_id=1)
Masses : [array([0.5 , 0.25, 0.25]), array([0.5 , 0.25, 0.25])]
</pre></div></div>
</div>
<p><strong>Important:</strong></p>
<p>Not all trajectory formats and backends support additional fields.</p>
<p>When reading, the <code class="docutils literal notranslate"><span class="pre">additional_fields</span></code> parameter may then be ignored for some formats (only positions and species will be read). The same applies when writing a trajectory.</p>
<p>On that regard, the XYZ format is probably the most flexible, being natively supported by the code.</p>
</div>
<div class="section" id="Setting-or-modifying-a-particle-property">
<h2><span class="section-number">1.4. </span>Setting or modifying a particle property<a class="headerlink" href="#Setting-or-modifying-a-particle-property" title="Permalink to this headline"></a></h2>
<p>As a counterpart for the method <code class="docutils literal notranslate"><span class="pre">set_property</span></code>, the method <code class="docutils literal notranslate"><span class="pre">set_property</span></code> allows to set or change a particle property trajectory-wide, for all particles or for a specific subset. This property can be either a scalar value, in which case it will be set to all the particles in the subset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/traj_with_masses.xyz&#39;</span><span class="p">,</span>
                  <span class="n">additional_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">])</span>

<span class="c1"># Current `mass` property</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.mass&#39;</span><span class="p">))</span>

<span class="c1"># Change it for all the particles</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.mass&#39;</span><span class="p">))</span>

<span class="c1"># Change it for a given subset</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.mass&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([0.5 , 0.25, 0.25]), array([0.5 , 0.25, 0.25])]
[array([1., 1., 1.]), array([1., 1., 1.])]
[array([1.  , 0.75, 0.75]), array([1.  , 0.75, 0.75])]
</pre></div></div>
</div>
<p>The property can also be a <code class="docutils literal notranslate"><span class="pre">list</span></code> or a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> that will be mapped to the particles (<em>i.e.</em> set values element by element). This is convenient if this property is read from another file or computed elsewhere in your code.</p>
<p>In this case, the parameter should have the right shape: same number of frames than the trajectory, and same number of particles than the considered subset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2 frames, 3 particles (same as the trajectory)</span>
<span class="n">masses</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
          <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">]]</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="n">masses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.mass&#39;</span><span class="p">))</span>

<span class="c1"># 2 frames, 2 particles</span>
<span class="c1">#  (because there are only B particles in the subset)</span>
<span class="n">masses</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">],</span>
          <span class="p">[</span><span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">]]</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="n">masses</span><span class="p">,</span> <span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.mass&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([0.5 , 0.25, 0.25]), array([0.6 , 0.35, 0.35])]
[array([0.5 , 0.23, 0.34]), array([0.6 , 0.56, 0.67])]
</pre></div></div>
</div>
<p>A property can also be set for a specific frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([0.75, 0.75, 0.75]), array([0.15, 0.25, 0.35])]
</pre></div></div>
</div>
<p>The property can also be a new property that the particles do not have yet:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set a new property</span>
<span class="n">energies</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">]]</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;particle.energy&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([0.51, 0.43, 0.37]), array([0.55, 0.44, 0.41])]
</pre></div></div>
</div>
<p>As mentioned above, it is crucial that the property is defined for all particles when calling the <code class="docutils literal notranslate"><span class="pre">dump</span></code> method or when applying a filter on a structural descriptor (see the <strong>Descriptors</strong> notebook).</p>
</div>
<div class="section" id="Visualizing-a-trajectory">
<h2><span class="section-number">1.5. </span>Visualizing a trajectory<a class="headerlink" href="#Visualizing-a-trajectory" title="Permalink to this headline"></a></h2>
<p>Simple and customizable visualization methods allow to display the trajectory frames using the <code class="docutils literal notranslate"><span class="pre">Trajectory.show</span></code> method. Currently supported visualization backends are <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">ovito</span></code> and <code class="docutils literal notranslate"><span class="pre">3dmol</span></code>. The specified <code class="docutils literal notranslate"><span class="pre">backend</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">Trajectory.show</span></code> method thus calls a backend-dependent function (<code class="docutils literal notranslate"><span class="pre">partycls.helpers</span></code> for more information).</p>
<p><strong>N.B.</strong> If a <code class="docutils literal notranslate"><span class="pre">radius</span></code> property is defined for the particles, this will display the particles accordingly. If not, this will use a default value for all the particles.</p>
<div class="section" id="Matplotlib">
<h3><span class="section-number">1.5.1. </span>Matplotlib<a class="headerlink" href="#Matplotlib" title="Permalink to this headline"></a></h3>
<p><em>(See the ``show_matplotlib`` function in ``partycls.helpers`` for more information)</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open a trajectory file</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/kalj_N150.xyz&#39;</span><span class="p">)</span>
<span class="c1"># adjust radii</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">)</span>

<span class="c1"># show the first three frames</span>
<span class="c1"># (all frames are shown if `frames` is not specified)</span>
<span class="c1"># default coloring code uses the species</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_49_0.png" src="../../_images/tutorials_notebooks_1_trajectory_49_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_49_1.png" src="../../_images/tutorials_notebooks_1_trajectory_49_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_49_2.png" src="../../_images/tutorials_notebooks_1_trajectory_49_2.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> class being iterable, one can also show a specific frame by calling <code class="docutils literal notranslate"><span class="pre">show</span></code> on an element of the trajectory:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the 5-th frame, change the view, use custom colors</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;back&#39;</span><span class="p">,</span>
                   <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_51_0.png" src="../../_images/tutorials_notebooks_1_trajectory_51_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># color particles according to an arbitrary *discrete* particle property</span>
<span class="c1"># (for the example, we randomly assign labels to the particles)</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">142</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_52_0.png" src="../../_images/tutorials_notebooks_1_trajectory_52_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># color particles according to an arbitrary *continuous* particle property</span>
<span class="c1"># (for the example, we randomly assign a random float property to the particles)</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="n">rn</span> <span class="o">=</span> <span class="p">[</span><span class="n">normal</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">)]</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">rn</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_53_0.png" src="../../_images/tutorials_notebooks_1_trajectory_53_0.png" />
</div>
</div>
</div>
<div class="section" id="Ovito">
<h3><span class="section-number">1.5.2. </span>Ovito<a class="headerlink" href="#Ovito" title="Permalink to this headline"></a></h3>
<p><em>(See the ``show_ovito`` function in ``partycls.helpers`` for more information)</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">partycls.trajectory</span> <span class="kn">import</span> <span class="n">Trajectory</span>

<span class="c1"># open a trajectory file</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/kalj_N150.xyz&#39;</span><span class="p">)</span>
<span class="c1"># adjust radii</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">)</span>

<span class="c1"># show the first frame</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s1">&#39;ovito&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_55_0.png" src="../../_images/tutorials_notebooks_1_trajectory_55_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># color particles according to an arbitrary *discrete* particle property</span>
<span class="c1"># (for the example, we randomly assign labels to the particles)</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">142</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># /!\ colors must be in RGB format</span>
<span class="n">ovito_colors</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.9</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)]</span>

<span class="c1"># show the first frame</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;ovito&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">ovito_colors</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_56_0.png" src="../../_images/tutorials_notebooks_1_trajectory_56_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># color particles according to an arbitrary *continuous* particle property</span>
<span class="c1"># (for the example, we randomly assign a random float property to the particles)</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="n">rn</span> <span class="o">=</span> <span class="p">[</span><span class="n">normal</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">)]</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">rn</span><span class="p">)</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;ovito&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_trajectory_57_0.png" src="../../_images/tutorials_notebooks_1_trajectory_57_0.png" />
</div>
</div>
</div>
<div class="section" id="py3Dmol">
<h3><span class="section-number">1.5.3. </span>py3Dmol<a class="headerlink" href="#py3Dmol" title="Permalink to this headline"></a></h3>
<p><em>(See the ``show_3dmol`` function in ``partycls.helpers`` for more information)</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open a trajectory file</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/dislocation.xyz&#39;</span><span class="p">)</span>

<span class="c1"># show the first frame</span>
<span class="c1"># default coloring code uses the species</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s1">&#39;3dmol&#39;</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="3dmolviewer_16364762933809633"  style="position: relative; width: 640px; height: 480px">
        <p id="3dmolwarning_16364762933809633" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_16364762933809633 = null;
var warn = document.getElementById("3dmolwarning_16364762933809633");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_16364762933809633 = $3Dmol.createViewer($("#3dmolviewer_16364762933809633"),{backgroundColor:"white"});
viewer_16364762933809633.zoomTo();
    viewer_16364762933809633.setBackgroundColor("white");
    viewer_16364762933809633.addSphere({"center": {"x": -0.8558697759106223, "y": -0.9649468530962736, "z": -0.8547344729254289}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.8602721518763825, "y": -0.9648737276151803, "z": 0.07381692809686763}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.9693498589008231, "y": -0.8932724529261576, "z": 1.0746978044385056}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.931003060892466, "y": 0.0906421084323454, "z": -0.9347219931645108}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.41118204395823243, "y": 0.5020889814008229, "z": 0.5287314044336557}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.870177462481879, "y": 0.05551840265243458, "z": 1.0242209579401511}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.3582105172550749, "y": 0.5497848691530429, "z": -0.48345960648419306}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.8794647092376797, "y": 1.0792744188157424, "z": 0.1473039076094796}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": -0.9189083416280903, "y": 1.0481397970631017, "z": 1.112564032055733}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.05301680314927515, "y": -0.94742785918522, "z": -0.8549464443794755}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.035559859853506105, "y": -0.9248481259320641, "z": 0.03006044024402194}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.14301474812636608, "y": -0.941787303853777, "z": 1.0613264970991187}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.11391750305127941, "y": 0.08678734589613311, "z": -0.8876543353736666}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.07491040207825587, "y": 0.035269921885601914, "z": 0.1414707503195194}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.108104060365299, "y": 0.048350815115693196, "z": 1.073786852813738}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.12185492860547649, "y": 1.1107175735832546, "z": -0.9703669149025768}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.13132859040703243, "y": 1.0514940202870073, "z": 0.07630951602117632}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 0.07016638117571933, "y": 1.1342226557565658, "z": 1.0634306782399423}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.0925840817949808, "y": -0.9847811179100662, "z": -0.9043616750186302}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.0132734377820958, "y": -0.9508336531796028, "z": 0.0390254098717825}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.0412750572714158, "y": -0.9101020887287774, "z": 1.0242910359044375}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.084215236443952, "y": 0.10752536526967194, "z": -0.9200580460168513}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.10988070397366, "y": 0.09913011275147743, "z": 0.048234301846316066}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.0270014439199402, "y": 0.07538931497658617, "z": 1.0565087011152035}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.0513188750026883, "y": 1.1457146007582395, "z": -0.9853513566331166}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.1375962924508913, "y": 1.085456784971159, "z": 0.021702114843469338}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addSphere({"center": {"x": 1.0361659497474067, "y": 1.1025921110714816, "z": 1.1065822071929692}, "radius": 0.5, "color": "#50514f"});
    viewer_16364762933809633.addBox({"center": {"x": 0.0, "y": 0.0, "z": 0.0}, "dimensions": {"w": 3.0, "h": 3.0, "d": 3.0}, "wireframe": true, "color": "#000000"});
viewer_16364762933809633.render();
});
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># color particles according to an arbitrary *discrete* particle property</span>
<span class="c1"># (for the example, we randomly assign labels to the particles)</span>
<span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s1">&#39;3dmol&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">])</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="3dmolviewer_1636476293387815"  style="position: relative; width: 640px; height: 480px">
        <p id="3dmolwarning_1636476293387815" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
      resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://3dmol.org/build/3Dmol.js');
}

var viewer_1636476293387815 = null;
var warn = document.getElementById("3dmolwarning_1636476293387815");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1636476293387815 = $3Dmol.createViewer($("#3dmolviewer_1636476293387815"),{backgroundColor:"white"});
viewer_1636476293387815.zoomTo();
    viewer_1636476293387815.setBackgroundColor("white");
    viewer_1636476293387815.addSphere({"center": {"x": -0.8558697759106223, "y": -0.9649468530962736, "z": -0.8547344729254289}, "radius": 0.5, "color": "red"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.8602721518763825, "y": -0.9648737276151803, "z": 0.07381692809686763}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.9693498589008231, "y": -0.8932724529261576, "z": 1.0746978044385056}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.931003060892466, "y": 0.0906421084323454, "z": -0.9347219931645108}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.41118204395823243, "y": 0.5020889814008229, "z": 0.5287314044336557}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.870177462481879, "y": 0.05551840265243458, "z": 1.0242209579401511}, "radius": 0.5, "color": "red"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.3582105172550749, "y": 0.5497848691530429, "z": -0.48345960648419306}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.8794647092376797, "y": 1.0792744188157424, "z": 0.1473039076094796}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": -0.9189083416280903, "y": 1.0481397970631017, "z": 1.112564032055733}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.05301680314927515, "y": -0.94742785918522, "z": -0.8549464443794755}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.035559859853506105, "y": -0.9248481259320641, "z": 0.03006044024402194}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.14301474812636608, "y": -0.941787303853777, "z": 1.0613264970991187}, "radius": 0.5, "color": "red"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.11391750305127941, "y": 0.08678734589613311, "z": -0.8876543353736666}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.07491040207825587, "y": 0.035269921885601914, "z": 0.1414707503195194}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.108104060365299, "y": 0.048350815115693196, "z": 1.073786852813738}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.12185492860547649, "y": 1.1107175735832546, "z": -0.9703669149025768}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.13132859040703243, "y": 1.0514940202870073, "z": 0.07630951602117632}, "radius": 0.5, "color": "red"});
    viewer_1636476293387815.addSphere({"center": {"x": 0.07016638117571933, "y": 1.1342226557565658, "z": 1.0634306782399423}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.0925840817949808, "y": -0.9847811179100662, "z": -0.9043616750186302}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.0132734377820958, "y": -0.9508336531796028, "z": 0.0390254098717825}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.0412750572714158, "y": -0.9101020887287774, "z": 1.0242910359044375}, "radius": 0.5, "color": "red"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.084215236443952, "y": 0.10752536526967194, "z": -0.9200580460168513}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.10988070397366, "y": 0.09913011275147743, "z": 0.048234301846316066}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.0270014439199402, "y": 0.07538931497658617, "z": 1.0565087011152035}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.0513188750026883, "y": 1.1457146007582395, "z": -0.9853513566331166}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.1375962924508913, "y": 1.085456784971159, "z": 0.021702114843469338}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addSphere({"center": {"x": 1.0361659497474067, "y": 1.1025921110714816, "z": 1.1065822071929692}, "radius": 0.5, "color": "blue"});
    viewer_1636476293387815.addBox({"center": {"x": 0.0, "y": 0.0, "z": 0.0}, "dimensions": {"w": 3.0, "h": 3.0, "d": 3.0}, "wireframe": true, "color": "#000000"});
viewer_1636476293387815.render();
});
</script></div>
</div>
<p><strong>N.B.</strong> the py3Dmol backend works well with small systems, but it tends to get pretty slow with larger systems.</p>
</div>
</div>
<div class="section" id="Writing-a-trajectory">
<h2><span class="section-number">1.6. </span>Writing a trajectory<a class="headerlink" href="#Writing-a-trajectory" title="Permalink to this headline"></a></h2>
<p>The class <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> can also write a trajectory file thanks to the <code class="docutils literal notranslate"><span class="pre">write</span></code> method. Once the input trajectory has been loaded at the creation of a <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> object, every communication with the original file is over: changing the current instance of <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> will have no effect on the original file.</p>
<p>Writing a new trajectory file from the current instance can then be useful for many reasons. For example, convert from a format to another:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open XYZ file</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/traj_with_masses.xyz&#39;</span><span class="p">)</span>

<span class="c1"># Write the trajectory in RUMD format (as a new file)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;../data/traj_with_masses.xyz.gz&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;rumd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Other example, write a trajectory file with additional fields that were not present in the original file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open XYZ file</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="s1">&#39;../data/traj_with_masses.xyz&#39;</span><span class="p">,</span> <span class="n">additional_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">])</span>

<span class="c1"># Set custom values for radii of the particles</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;species == &#39;A&#39;&quot;</span><span class="p">)</span>
<span class="n">traj</span><span class="o">.</span><span class="n">set_property</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;species == &#39;B&#39;&quot;</span><span class="p">)</span>

<span class="c1"># Write a new file with both masses and radii</span>
<span class="n">traj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;../data/traj_with_masses_and_radii.xyz&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">additional_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_workflow.html" class="btn btn-neutral float-right" title="2. Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Joris Paret.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>